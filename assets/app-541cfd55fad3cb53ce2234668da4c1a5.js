(function(){var t,e,n,i,s,r,o,a,h,u,c,l,p,E,d,f,T,A,O,S,R,m,g,I,_,N,C,y,v,D,H,L,P,M,F,Y,U,b=function(t,e){return function(){return t.apply(e,arguments)}},x=[].slice;t=jQuery,M=0,F=1,Y=2,_=13,H=9,m=46,R=8,C=37,D=39,L=38,g=40,N=36,I=35,v=33,y=34,h="jqconsole-",s=""+h+"cursor",r=""+h+"header",u=""+h+"prompt",a=""+h+"old-prompt",o=""+h+"input",i=""+h+"blurred",O="keypress",f="<span/>",E="<div/>",d=":empty",P="\n",p=">>> ",l="... ",c=2,n=""+h+"ansi-",T="",A=/\[(\d*)(?:;(\d*))*m/,e=function(){function t(){this.stylize=b(this.stylize,this),this._closeSpan=b(this._closeSpan,this),this._openSpan=b(this._openSpan,this),this.getClasses=b(this.getClasses,this),this._style=b(this._style,this),this._color=b(this._color,this),this._remove=b(this._remove,this),this._append=b(this._append,this),this.klasses=[]}return t.prototype.COLORS=["black","red","green","yellow","blue","magenta","cyan","white"],t.prototype._append=function(t){return t=""+n+t,-1===this.klasses.indexOf(t)?this.klasses.push(t):void 0},t.prototype._remove=function(){var t,e,i,s,r,o;for(i=1<=arguments.length?x.call(arguments,0):[],o=[],s=0,r=i.length;r>s;s++)e=i[s],"fonts"===e||"color"===e||"background-color"===e?o.push(this.klasses=function(){var i,s,r,o;for(r=this.klasses,o=[],i=0,s=r.length;s>i;i++)t=r[i],t.indexOf(e)!==n.length&&o.push(t);return o}.call(this)):(e=""+n+e,o.push(this.klasses=function(){var n,i,s,r;for(s=this.klasses,r=[],n=0,i=s.length;i>n;n++)t=s[n],t!==e&&r.push(t);return r}.call(this)));return o},t.prototype._color=function(t){return this.COLORS[t]},t.prototype._style=function(t){if(""===t&&(t=0),t=parseInt(t),!isNaN(t))switch(t){case 0:return this.klasses=[];case 1:return this._append("bold");case 2:return this._append("lighter");case 3:return this._append("italic");case 4:return this._append("underline");case 5:return this._append("blink");case 6:return this._append("blink-rapid");case 8:return this._append("hidden");case 9:return this._append("line-through");case 10:return this._remove("fonts");case 11:case 12:case 13:case 14:case 15:case 16:case 17:case 18:case 19:return this._remove("fonts"),this._append("fonts-"+(t-10));case 20:return this._append("fraktur");case 21:return this._remove("bold","lighter");case 22:return this._remove("bold","lighter");case 23:return this._remove("italic","fraktur");case 24:return this._remove("underline");case 25:return this._remove("blink","blink-rapid");case 28:return this._remove("hidden");case 29:return this._remove("line-through");case 30:case 31:case 32:case 33:case 34:case 35:case 36:case 37:return this._remove("color"),this._append("color-"+this._color(t-30));case 39:return this._remove("color");case 40:case 41:case 42:case 43:case 44:case 45:case 46:case 47:return this._remove("background-color"),this._append("background-color-"+this._color(t-40));case 49:return this._remove("background-color");case 51:return this._append("framed");case 53:return this._append("overline");case 54:return this._remove("framed");case 55:return this._remove("overline")}},t.prototype.getClasses=function(){return this.klasses.join(" ")},t.prototype._openSpan=function(t){return'<span class="'+this.getClasses()+'">'+t},t.prototype._closeSpan=function(t){return""+t+"</span>"},t.prototype.stylize=function(t){var e,n,i,s,r,o;for(t=this._openSpan(t),i=0;(i=t.indexOf(T,i))&&-1!==i;)if(n=t.slice(i).match(A)){for(o=n.slice(1),s=0,r=o.length;r>s;s++)e=o[s],this._style(e);t=this._closeSpan(t.slice(0,i))+this._openSpan(t.slice(i+1+n[0].length))}else i++;return this._closeSpan(t)},t}(),U=function(t,e){return'<span class="'+t+'">'+(e||"")+"</span>"},S=function(){function n(n,i,s,o){this._HideComposition=b(this._HideComposition,this),this._ShowComposition=b(this._ShowComposition,this),this._UpdateComposition=b(this._UpdateComposition,this),this._EndComposition=b(this._EndComposition,this),this._StartComposition=b(this._StartComposition,this),this._CheckComposition=b(this._CheckComposition,this),this._ProcessMatch=b(this._ProcessMatch,this),this._HandleKey=b(this._HandleKey,this),this._HandleChar=b(this._HandleChar,this),this.isMobile=!!navigator.userAgent.match(/iPhone|iPad|iPod|Android/i),this.isIos=!!navigator.userAgent.match(/iPhone|iPad|iPod/i),this.isAndroid=!!navigator.userAgent.match(/Android/i),this.$window=t(window),this.header=i||"",this.prompt_label_main="string"==typeof s?s:p,this.prompt_label_continue=o||l,this.indent_width=c,this.state=F,this.input_queue=[],this.input_callback=null,this.multiline_callback=null,this.history=[],this.history_index=0,this.history_new="",this.history_active=!1,this.shortcuts={},this.$container=t("<div/>").appendTo(n),this.$container.css({top:0,left:0,right:0,bottom:0,position:"absolute",overflow:"auto"}),this.$console=t('<pre class="jqconsole"/>').appendTo(this.$container),this.$console.css({margin:0,position:"relative","min-height":"100%","box-sizing":"border-box","-moz-box-sizing":"border-box","-webkit-box-sizing":"border-box"}),this.$console_focused=!0,this.$input_container=t(E).appendTo(this.$container),this.$input_container.css({position:"absolute",width:1,height:0,overflow:"hidden"}),this.$input_source=t(this.isAndroid?"<input/>":"<textarea/>"),this.$input_source.attr({wrap:"off",autocapitalize:"off",autocorrect:"off",spellcheck:"false",autocomplete:"off"}),this.$input_source.css({position:"absolute",width:2}),this.$input_source.appendTo(this.$input_container),this.$composition=t(E),this.$composition.addClass(""+h+"composition"),this.$composition.css({display:"inline",position:"relative"}),this.matchings={openings:{},closings:{},clss:[]},this.ansi=new e,this._InitPrompt(),this._SetupEvents(),this.Write(this.header,r),t(n).data("jqconsole",this)}return n.prototype.ResetHistory=function(){return this.SetHistory([])},n.prototype.ResetShortcuts=function(){return this.shortcuts={}},n.prototype.ResetMatchings=function(){return this.matchings={openings:{},closings:{},clss:[]}},n.prototype.Reset=function(){return this.state!==F&&this.ClearPromptText(!0),this.state=F,this.input_queue=[],this.input_callback=null,this.multiline_callback=null,this.ResetHistory(),this.ResetShortcuts(),this.ResetMatchings(),this.$prompt.detach(),this.$input_container.detach(),this.$console.html(""),this.$prompt.appendTo(this.$console),this.$input_container.appendTo(this.$container),void this.Write(this.header,r)},n.prototype.GetHistory=function(){return this.history},n.prototype.SetHistory=function(t){return this.history=t.slice(),this.history_index=this.history.length},n.prototype._CheckKeyCode=function(t){if(t=isNaN(t)?t.charCodeAt(0):parseInt(t,10),!(t>0&&256>t)||isNaN(t))throw new Error("Key code must be a number between 0 and 256 exclusive.");return t},n.prototype._LetterCaseHelper=function(t,e){return e(t),t>=65&&90>=t&&e(t+32),t>=97&&122>=t?e(t-32):void 0},n.prototype.RegisterShortcut=function(t,e){var n;if(t=this._CheckKeyCode(t),"function"!=typeof e)throw new Error("Callback must be a function, not "+e+".");return n=function(t){return function(n){return n in t.shortcuts||(t.shortcuts[n]=[]),t.shortcuts[n].push(e)}}(this),void this._LetterCaseHelper(t,n)},n.prototype.UnRegisterShortcut=function(t,e){var n;return t=this._CheckKeyCode(t),n=function(t){return function(n){return n in t.shortcuts?e?t.shortcuts[n].splice(t.shortcuts[n].indexOf(e),1):delete t.shortcuts[n]:void 0}}(this),void this._LetterCaseHelper(t,n)},n.prototype.GetColumn=function(){var t;return this.$prompt_right.detach(),this.$prompt_cursor.text(""),t=this.$console.text().split(P),this.$prompt_cursor.html("&nbsp;"),this.$prompt_cursor.after(this.$prompt_right),t[t.length-1].length},n.prototype.GetLine=function(){return this.$console.text().split(P).length-1},n.prototype.ClearPromptText=function(t){if(this.state===F)throw new Error("ClearPromptText() is not allowed in output state.");return this.$prompt_before.html(""),this.$prompt_after.html(""),this.$prompt_label.text(t?"":this._SelectPromptLabel(!1)),this.$prompt_left.text(""),void this.$prompt_right.text("")},n.prototype.GetPromptText=function(e){var n,i,s,r,o;if(this.state===F)throw new Error("GetPromptText() is not allowed in output state.");return e?(this.$prompt_cursor.text(""),o=this.$prompt.text(),this.$prompt_cursor.html("&nbsp;"),o):(r=function(e){var n;return n=[],e.children().each(function(){return n.push(t(this).children().last().text())}),n.join(P)},i=r(this.$prompt_before),i&&(i+=P),s=this.$prompt_left.text()+this.$prompt_right.text(),n=r(this.$prompt_after),n&&(n=P+n),i+s+n)},n.prototype.SetPromptText=function(t){if(this.state===F)throw new Error("SetPromptText() is not allowed in output state.");return this.ClearPromptText(!1),this._AppendPromptText(t),void this._ScrollToEnd()},n.prototype.SetPromptLabel=function(t,e){return this.prompt_label_main=t,void(null!=e&&(this.prompt_label_continue=e))},n.prototype.Write=function(e,n,i){var s;return null==i&&(i=!0),i&&(e=this.ansi.stylize(t(f).text(e).html())),s=t(f).html(e),null!=n&&s.addClass(n),this.Append(s)},n.prototype.Append=function(e){var n;return n=t(e).insertBefore(this.$prompt),this._ScrollToEnd(),this.$prompt_cursor.detach().insertAfter(this.$prompt_left),n},n.prototype.Input=function(t){var e,n,i,s;if(this.state===Y)i=this.input_callback,s=this.multiline_callback,n=this.history_active,e=this.async_multiline,this.AbortPrompt(),this.input_queue.unshift(function(t){return function(){return t.Prompt(n,i,s,e)}}(this));else if(this.state!==F)return void this.input_queue.push(function(e){return function(){return e.Input(t)}}(this));return this.history_active=!1,this.input_callback=t,this.multiline_callback=null,this.state=M,this.$prompt.attr("class",o),this.$prompt_label.text(this._SelectPromptLabel(!1)),this.Focus(),void this._ScrollToEnd()},n.prototype.Prompt=function(t,e,n,i){return this.state!==F?void this.input_queue.push(function(s){return function(){return s.Prompt(t,e,n,i)}}(this)):(this.history_active=t,this.input_callback=e,this.multiline_callback=n,this.async_multiline=i,this.state=Y,this.$prompt.attr("class",u+" "+this.ansi.getClasses()),this.$prompt_label.text(this._SelectPromptLabel(!1)),this.Focus(),void this._ScrollToEnd())},n.prototype.AbortPrompt=function(){if(this.state!==Y)throw new Error("Cannot abort prompt when not in prompt state.");return this.Write(this.GetPromptText(!0)+P,a),this.ClearPromptText(!0),this.state=F,this.input_callback=this.multiline_callback=null,void this._CheckInputQueue()},n.prototype.Focus=function(){return void(this.IsDisabled()||this.$input_source.focus())},n.prototype.SetIndentWidth=function(t){return this.indent_width=t},n.prototype.GetIndentWidth=function(){return this.indent_width},n.prototype.RegisterMatching=function(t,e,n){var i;return i={opening_char:t,closing_char:e,cls:n},this.matchings.clss.push(n),this.matchings.openings[t]=i,this.matchings.closings[e]=i},n.prototype.UnRegisterMatching=function(t,e){var n;return n=this.matchings.openings[t].cls,delete this.matchings.openings[t],delete this.matchings.closings[e],this.matchings.clss.splice(this.matchings.clss.indexOf(n),1)},n.prototype.Dump=function(){var e,n;return e=this.$console.find("."+r).nextUntil("."+u).addBack(),function(){var i,s,r;for(r=[],i=0,s=e.length;s>i;i++)n=e[i],r.push(t(n).is("."+a)?t(n).text().replace(/^\s+/,">>> "):t(n).text());return r}().join("")},n.prototype.GetState=function(){return this.state===M?"input":this.state===F?"output":"prompt"},n.prototype.Disable=function(){return this.$input_source.attr("disabled",!0),this.$input_source.blur()},n.prototype.Enable=function(){return this.$input_source.attr("disabled",!1)},n.prototype.IsDisabled=function(){return Boolean(this.$input_source.attr("disabled"))},n.prototype.MoveToStart=function(t){return void this._MoveTo(t,!0)},n.prototype.MoveToEnd=function(t){return void this._MoveTo(t,!1)},n.prototype.Clear=function(){return this.$console.find("."+r).nextUntil("."+u).addBack().text(""),this.$prompt_cursor.detach(),this.$prompt_after.before(this.$prompt_cursor)},n.prototype._CheckInputQueue=function(){return this.input_queue.length?this.input_queue.shift()():void 0},n.prototype._InitPrompt=function(){return this.$prompt=t(U(o)).appendTo(this.$console),this.$prompt_before=t(f).appendTo(this.$prompt),this.$prompt_current=t(f).appendTo(this.$prompt),this.$prompt_after=t(f).appendTo(this.$prompt),this.$prompt_label=t(f).appendTo(this.$prompt_current),this.$prompt_left=t(f).appendTo(this.$prompt_current),this.$prompt_right=t(f).appendTo(this.$prompt_current),this.$prompt_right.css({position:"relative"}),this.$prompt_cursor=t(U(s,"&nbsp;")),this.$prompt_cursor.insertBefore(this.$prompt_right),this.$prompt_cursor.css({color:"transparent",display:"inline",zIndex:0}),this.isMobile?void 0:this.$prompt_cursor.css("position","absolute")},n.prototype._SetupEvents=function(){return this.isMobile?this.$console.click(function(t){return function(e){return e.preventDefault(),t.Focus()}}(this)):this.$console.mouseup(function(t){return function(e){var n;return 2===e.which?t.Focus():(n=function(){return window.getSelection().toString()?void 0:(e.preventDefault(),t.Focus())},setTimeout(n,0))}}(this)),this.$input_source.focus(function(t){return function(){var e,n;return t._ScrollToEnd(),t.$console_focused=!0,t.$console.removeClass(i),n=function(){return t.$console_focused?t.$console.removeClass(i):void 0},setTimeout(n,100),e=function(){return t.isIos&&t.$console_focused?t.$input_source.hide():void 0},setTimeout(e,500)}}(this)),this.$input_source.blur(function(t){return function(){var e;return t.$console_focused=!1,t.isIos&&t.$input_source.show(),e=function(){return t.$console_focused?void 0:t.$console.addClass(i)},setTimeout(e,100)}}(this)),this.$input_source.bind("paste",function(t){return function(){var e;return e=function(){return t.in_composition?void 0:(t._AppendPromptText(t.$input_source.val()),t.$input_source.val(""),t.Focus())},setTimeout(e,0)}}(this)),this.$input_source.keypress(this._HandleChar),this.$input_source.keydown(this._HandleKey),this.$input_source.keydown(this._CheckComposition),this.$input_source.bind("compositionstart",this._StartComposition),this.$input_source.bind("compositionend",function(t){return function(e){return setTimeout(function(){return t._EndComposition(e)},0)}}(this)),this.isAndroid?(this.$input_source.bind("input",this._StartComposition),this.$input_source.bind("input",this._UpdateComposition)):this.$input_source.bind("text",this._UpdateComposition)},n.prototype._HandleChar=function(t){var e;return this.state===F||t.metaKey||t.ctrlKey?!0:(e=t.which,8===e||9===e||13===e?!1:(this.$prompt_left.text(this.$prompt_left.text()+String.fromCharCode(e)),this._ScrollToEnd(),!1))},n.prototype._HandleKey=function(e){var n;if(this.state===F)return!0;if(n=e.keyCode||e.which,setTimeout(t.proxy(this._CheckMatchings,this),0),e.altKey)return!0;if(e.ctrlKey||e.metaKey)return this._HandleCtrlShortcut(n);if(e.shiftKey){switch(n){case _:this._HandleEnter(!0);break;case H:this._Unindent();break;case L:this._MoveUp();break;case g:this._MoveDown();break;case v:this._ScrollPage("up");break;case y:this._ScrollPage("down");break;default:return!0}return!1}switch(n){case _:this._HandleEnter(!1);break;case H:this._Indent();break;case m:this._Delete(!1);break;case R:this._Backspace(!1);break;case C:this._MoveLeft(!1);break;case D:this._MoveRight(!1);break;case L:this._HistoryPrevious();break;case g:this._HistoryNext();break;case N:this.MoveToStart(!1);break;case I:this.MoveToEnd(!1);break;case v:this._ScrollPage("up");break;case y:this._ScrollPage("down");break;default:return!0}return!1},n.prototype._HandleCtrlShortcut=function(t){var e,n,i,s;switch(t){case m:this._Delete(!0);break;case R:this._Backspace(!0);break;case C:this._MoveLeft(!0);break;case D:this._MoveRight(!0);break;case L:this._MoveUp();break;case g:this._MoveDown();break;case I:this.MoveToEnd(!0);break;case N:this.MoveToStart(!0);break;default:if(t in this.shortcuts){for(s=this.shortcuts[t],n=0,i=s.length;i>n;n++)e=s[n],e.call(this);return!1}return!0}return!1},n.prototype._HandleEnter=function(t){var e,n;return this._EndComposition(),t?this._InsertNewLine(!0):(n=this.GetPromptText(),e=function(t){return function(e){var i,s,r,o,a,u;if(e!==!1){for(t.MoveToEnd(!0),t._InsertNewLine(!0),u=[],r=o=0,a=Math.abs(e);a>=0?a>o:o>a;r=a>=0?++o:--o)u.push(e>0?t._Indent():t._Unindent());return u}return s=t.state===M?"input":"prompt",t.Write(t.GetPromptText(!0)+P,""+h+"old-"+s),t.ClearPromptText(!0),t.history_active&&(t.history.length&&t.history[t.history.length-1]===n||t.history.push(n),t.history_index=t.history.length),t.state=F,i=t.input_callback,t.input_callback=null,i&&i(n),t._CheckInputQueue()}}(this),this.multiline_callback?this.async_multiline?this.multiline_callback(n,e):e(this.multiline_callback(n)):e(!1))},n.prototype._GetDirectionals=function(e){var n,i,s,r,o,a,h,u;return r=e?this.$prompt_left:this.$prompt_right,n=e?this.$prompt_right:this.$prompt_left,s=e?this.$prompt_before:this.$prompt_after,i=e?this.$prompt_after:this.$prompt_before,a=e?t.proxy(this.MoveToStart,this):t.proxy(this.MoveToEnd,this),o=e?t.proxy(this._MoveLeft,this):t.proxy(this._MoveRight,this),u=e?"last":"first",h=e?"prependTo":"appendTo",{$prompt_which:r,$prompt_opposite:n,$prompt_relative:s,$prompt_rel_opposite:i,MoveToLimit:a,MoveDirection:o,which_end:u,where_append:h}},n.prototype._VerticalMove=function(t){var e,n,i,s,r,o,a,h;return h=this._GetDirectionals(t),i=h.$prompt_which,e=h.$prompt_opposite,n=h.$prompt_relative,r=h.MoveToLimit,s=h.MoveDirection,n.is(d)?void 0:(o=this.$prompt_left.text().length,r(),s(),a=i.text(),e.text(t?a.slice(o):a.slice(0,o)),i.text(t?a.slice(0,o):a.slice(o)))},n.prototype._MoveUp=function(){return this._VerticalMove(!0)},n.prototype._MoveDown=function(){return this._VerticalMove()},n.prototype._HorizontalMove=function(e,n){var i,s,r,o,a,h,u,c,l,p,E,T,A,O;if(O=this._GetDirectionals(n),a=O.$prompt_which,s=O.$prompt_opposite,o=O.$prompt_relative,r=O.$prompt_rel_opposite,T=O.which_end,E=O.where_append,c=n?/\w*\W*$/:/^\w*\W*/,l=a.text()){if(e){if(A=l.match(c),!A)return;return A=A[0],p=s.text(),s.text(n?A+p:p+A),u=A.length,a.text(n?l.slice(0,-u):l.slice(u))}return p=s.text(),s.text(n?l.slice(-1)+p:p+l[0]),a.text(n?l.slice(0,-1):l.slice(1))}return o.is(d)?void 0:(h=t(f)[E](r),h.append(t(f).text(this.$prompt_label.text())),h.append(t(f).text(s.text())),i=o.children()[T]().detach(),this.$prompt_label.text(i.children().first().text()),a.text(i.children().last().text()),s.text(""))},n.prototype._MoveLeft=function(t){return this._HorizontalMove(t,!0)},n.prototype._MoveRight=function(t){return this._HorizontalMove(t)},n.prototype._MoveTo=function(t,e){var n,i,s,r,o,a,h;if(a=this._GetDirectionals(e),s=a.$prompt_which,n=a.$prompt_opposite,i=a.$prompt_relative,o=a.MoveToLimit,r=a.MoveDirection,t){for(h=[];!i.is(d)||""!==s.text();)o(!1),h.push(r(!1));return h}return n.text(this.$prompt_left.text()+this.$prompt_right.text()),s.text("")},n.prototype._Delete=function(t){var e,n,i;if(n=this.$prompt_right.text()){if(t){if(i=n.match(/^\w*\W*/),!i)return;return i=i[0],this.$prompt_right.text(n.slice(i.length))}return this.$prompt_right.text(n.slice(1))}return this.$prompt_after.is(d)?void 0:(e=this.$prompt_after.children().first().detach(),this.$prompt_right.text(e.children().last().text()))},n.prototype._Backspace=function(e){var n,i,s;if(setTimeout(t.proxy(this._ScrollToEnd,this),0),i=this.$prompt_left.text()){if(e){if(s=i.match(/\w*\W*$/),!s)return;return s=s[0],this.$prompt_left.text(i.slice(0,-s.length))}return this.$prompt_left.text(i.slice(0,-1))}return this.$prompt_before.is(d)?void 0:(n=this.$prompt_before.children().last().detach(),this.$prompt_label.text(n.children().first().text()),this.$prompt_left.text(n.children().last().text()))},n.prototype._Indent=function(){var t;return this.$prompt_left.prepend(function(){var e,n,i;for(i=[],t=e=1,n=this.indent_width;n>=1?n>=e:e>=n;t=n>=1?++e:--e)i.push(" ");return i}.call(this).join(""))},n.prototype._Unindent=function(){var t,e,n,i,s;for(t=this.$prompt_left.text()+this.$prompt_right.text(),s=[],e=n=1,i=this.indent_width;(i>=1?i>=n:n>=i)&&/^ /.test(t);e=i>=1?++n:--n)this.$prompt_left.text()?this.$prompt_left.text(this.$prompt_left.text().slice(1)):this.$prompt_right.text(this.$prompt_right.text().slice(1)),s.push(t=t.slice(1));return s},n.prototype._InsertNewLine=function(e){var n,i,s;return null==e&&(e=!1),s=this._SelectPromptLabel(!this.$prompt_before.is(d)),n=t(f).appendTo(this.$prompt_before),n.append(t(f).text(s)),n.append(t(f).text(this.$prompt_left.text())),this.$prompt_label.text(this._SelectPromptLabel(!0)),this.$prompt_left.text(e&&(i=this.$prompt_left.text().match(/^\s+/))?i[0]:""),this._ScrollToEnd()},n.prototype._AppendPromptText=function(t){var e,n,i,s,r,o;for(n=t.split(P),this.$prompt_left.text(this.$prompt_left.text()+n[0]),r=n.slice(1),o=[],i=0,s=r.length;s>i;i++)e=r[i],this._InsertNewLine(),o.push(this.$prompt_left.text(e));return o},n.prototype._ScrollPage=function(t){var e;return e=this.$container[0].scrollTop,"up"===t?e-=this.$container.height():e+=this.$container.height(),this.$container.stop().animate({scrollTop:e},"fast")},n.prototype._ScrollToEnd=function(){var t;return this.$container.scrollTop(this.$container[0].scrollHeight),t=this.$prompt_cursor.position(),this.$input_container.css({left:t.left,top:t.top})},n.prototype.ScrollWindowToPrompt=function(){var t,e,n,i,s,r;if(e=this.$prompt_cursor.height(),r=this.$window.scrollTop(),s=this.$window.scrollLeft(),t=document.documentElement.clientHeight,i=this.$prompt_cursor.offset(),n=i.top-2*e,this.isMobile&&"undefined"!=typeof orientation&&null!==orientation){if(r<i.top||r>i.top)return this.$window.scrollTop(n)}else{if(r+t<i.top)return this.$window.scrollTop(i.top-t+e);if(r>n)return this.$window.scrollTop(i.top)}},n.prototype._SelectPromptLabel=function(t){return this.state===Y?t?" \n"+this.prompt_label_continue:this.prompt_label_main:t?"\n ":" "},n.prototype._Wrap=function(t,e,n){var i,s;return s=t.html(),i=s.slice(0,e)+U(n,s[e])+s.slice(e+1),t.html(i)},n.prototype._WalkCharacters=function(t,e,n,i,s){var r,o,a;for(o=s?t.length:0,t=t.split(""),a=function(){var e,n,i,r;return s?(i=t,t=2<=i.length?x.call(i,0,n=i.length-1):(n=0,[]),e=i[n++]):(r=t,e=r[0],t=2<=r.length?x.call(r,1):[]),e&&(o+=s?-1:1),e};r=a();)if(r===e?i++:r===n&&i--,0===i)return{index:o,current_count:i};return{index:-1,current_count:i}},n.prototype._ProcessMatch=function(e,n,i){var s,r,o,a,h,u,c,l,p,E,d,f;return E=n?[e.closing_char,e.opening_char]:[e.opening_char,e.closing_char],a=E[0],l=E[1],d=this._GetDirectionals(n),o=d.$prompt_which,r=d.$prompt_relative,h=1,u=!1,p=o.html(),n||(p=p.slice(1)),i&&n&&(p=p.slice(0,-1)),f=this._WalkCharacters(p,a,l,h,n),c=f.index,h=f.current_count,c>-1?(this._Wrap(o,c,e.cls),u=!0):(s=r.children(),s=n?Array.prototype.reverse.call(s):s,s.each(function(i){return function(s,r){var o,E;return o=t(r).children().last(),p=o.html(),E=i._WalkCharacters(p,a,l,h,n),c=E.index,h=E.current_count,c>-1?(n||c--,i._Wrap(o,c,e.cls),u=!0,!1):void 0}}(this))),u},n.prototype._CheckMatchings=function(e){var n,i,s,r,o,a,h;for(s=e?this.$prompt_left.text().slice(this.$prompt_left.text().length-1):this.$prompt_right.text()[0],h=this.matchings.clss,o=0,a=h.length;a>o;o++)n=h[o],t("."+n,this.$console).contents().unwrap();if((i=this.matchings.closings[s])?r=this._ProcessMatch(i,!0,e):(i=this.matchings.openings[s])?r=this._ProcessMatch(i,!1,e):e||this._CheckMatchings(!0),e){if(r)return this._Wrap(this.$prompt_left,this.$prompt_left.html().length-1,i.cls)}else if(r)return this._Wrap(this.$prompt_right,0,i.cls)},n.prototype._HistoryPrevious=function(){return!this.history_active||this.history_index<=0?void 0:(this.history_index===this.history.length&&(this.history_new=this.GetPromptText()),this.SetPromptText(this.history[--this.history_index]))},n.prototype._HistoryNext=function(){return!this.history_active||this.history_index>=this.history.length?void 0:this.history_index===this.history.length-1?(this.history_index++,this.SetPromptText(this.history_new)):this.SetPromptText(this.history[++this.history_index])},n.prototype._CheckComposition=function(t){var e;return e=t.keyCode||t.which,229===e?this.in_composition?this._UpdateComposition():this._StartComposition():void 0},n.prototype._StartComposition=function(){return this.in_composition?void 0:(this.in_composition=!0,this._ShowComposition(),setTimeout(this._UpdateComposition,0))},n.prototype._EndComposition=function(){return this.in_composition?(this._HideComposition(),this.$prompt_left.text(this.$prompt_left.text()+this.$composition.text()),this.$composition.text(""),this.$input_source.val(""),this.in_composition=!1):void 0},n.prototype._UpdateComposition=function(){var t;return t=function(t){return function(){return t.in_composition?t.$composition.text(t.$input_source.val()):void 0}}(this),setTimeout(t,0)},n.prototype._ShowComposition=function(){return this.$composition.css("height",this.$prompt_cursor.height()),this.$composition.empty(),this.$composition.appendTo(this.$prompt_left)},n.prototype._HideComposition=function(){return this.$composition.detach()},n}(),t.fn.jqconsole=function(t,e,n){return new S(this,t,e,n)},t.fn.jqconsole.JQConsole=S,t.fn.jqconsole.Ansi=e}).call(this),function(){var t=this,e=t._,n={},i=Array.prototype,s=Object.prototype,r=Function.prototype,o=i.push,a=i.slice,h=i.concat,u=s.toString,c=s.hasOwnProperty,l=i.forEach,p=i.map,E=i.reduce,d=i.reduceRight,f=i.filter,T=i.every,A=i.some,O=i.indexOf,S=i.lastIndexOf,R=Array.isArray,m=Object.keys,g=r.bind,I=function(t){return t instanceof I?t:this instanceof I?void(this._wrapped=t):new I(t)};"undefined"!=typeof exports?("undefined"!=typeof module&&module.exports&&(exports=module.exports=I),exports._=I):t._=I,I.VERSION="1.6.0";var _=I.each=I.forEach=function(t,e,i){if(null==t)return t;if(l&&t.forEach===l)t.forEach(e,i);else if(t.length===+t.length){for(var s=0,r=t.length;r>s;s++)if(e.call(i,t[s],s,t)===n)return}else for(var o=I.keys(t),s=0,r=o.length;r>s;s++)if(e.call(i,t[o[s]],o[s],t)===n)return;return t};I.map=I.collect=function(t,e,n){var i=[];return null==t?i:p&&t.map===p?t.map(e,n):(_(t,function(t,s,r){i.push(e.call(n,t,s,r))}),i)};var N="Reduce of empty array with no initial value";I.reduce=I.foldl=I.inject=function(t,e,n,i){var s=arguments.length>2;if(null==t&&(t=[]),E&&t.reduce===E)return i&&(e=I.bind(e,i)),s?t.reduce(e,n):t.reduce(e);if(_(t,function(t,r,o){s?n=e.call(i,n,t,r,o):(n=t,s=!0)}),!s)throw new TypeError(N);return n},I.reduceRight=I.foldr=function(t,e,n,i){var s=arguments.length>2;if(null==t&&(t=[]),d&&t.reduceRight===d)return i&&(e=I.bind(e,i)),s?t.reduceRight(e,n):t.reduceRight(e);var r=t.length;if(r!==+r){var o=I.keys(t);r=o.length}if(_(t,function(a,h,u){h=o?o[--r]:--r,s?n=e.call(i,n,t[h],h,u):(n=t[h],s=!0)}),!s)throw new TypeError(N);return n},I.find=I.detect=function(t,e,n){var i;return C(t,function(t,s,r){return e.call(n,t,s,r)?(i=t,!0):void 0}),i},I.filter=I.select=function(t,e,n){var i=[];return null==t?i:f&&t.filter===f?t.filter(e,n):(_(t,function(t,s,r){e.call(n,t,s,r)&&i.push(t)}),i)},I.reject=function(t,e,n){return I.filter(t,function(t,i,s){return!e.call(n,t,i,s)},n)},I.every=I.all=function(t,e,i){e||(e=I.identity);var s=!0;return null==t?s:T&&t.every===T?t.every(e,i):(_(t,function(t,r,o){return(s=s&&e.call(i,t,r,o))?void 0:n}),!!s)};var C=I.some=I.any=function(t,e,i){e||(e=I.identity);var s=!1;return null==t?s:A&&t.some===A?t.some(e,i):(_(t,function(t,r,o){return s||(s=e.call(i,t,r,o))?n:void 0}),!!s)};I.contains=I.include=function(t,e){return null==t?!1:O&&t.indexOf===O?-1!=t.indexOf(e):C(t,function(t){return t===e})},I.invoke=function(t,e){var n=a.call(arguments,2),i=I.isFunction(e);return I.map(t,function(t){return(i?e:t[e]).apply(t,n)})},I.pluck=function(t,e){return I.map(t,I.property(e))},I.where=function(t,e){return I.filter(t,I.matches(e))},I.findWhere=function(t,e){return I.find(t,I.matches(e))},I.max=function(t,e,n){if(!e&&I.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.max.apply(Math,t);var i=-1/0,s=-1/0;return _(t,function(t,r,o){var a=e?e.call(n,t,r,o):t;a>s&&(i=t,s=a)}),i},I.min=function(t,e,n){if(!e&&I.isArray(t)&&t[0]===+t[0]&&t.length<65535)return Math.min.apply(Math,t);var i=1/0,s=1/0;return _(t,function(t,r,o){var a=e?e.call(n,t,r,o):t;s>a&&(i=t,s=a)}),i},I.shuffle=function(t){var e,n=0,i=[];return _(t,function(t){e=I.random(n++),i[n-1]=i[e],i[e]=t}),i},I.sample=function(t,e,n){return null==e||n?(t.length!==+t.length&&(t=I.values(t)),t[I.random(t.length-1)]):I.shuffle(t).slice(0,Math.max(0,e))};var y=function(t){return null==t?I.identity:I.isFunction(t)?t:I.property(t)};I.sortBy=function(t,e,n){return e=y(e),I.pluck(I.map(t,function(t,i,s){return{value:t,index:i,criteria:e.call(n,t,i,s)}}).sort(function(t,e){var n=t.criteria,i=e.criteria;if(n!==i){if(n>i||void 0===n)return 1;if(i>n||void 0===i)return-1}return t.index-e.index}),"value")};var v=function(t){return function(e,n,i){var s={};return n=y(n),_(e,function(r,o){var a=n.call(i,r,o,e);t(s,a,r)}),s}};I.groupBy=v(function(t,e,n){I.has(t,e)?t[e].push(n):t[e]=[n]}),I.indexBy=v(function(t,e,n){t[e]=n}),I.countBy=v(function(t,e){I.has(t,e)?t[e]++:t[e]=1}),I.sortedIndex=function(t,e,n,i){n=y(n);for(var s=n.call(i,e),r=0,o=t.length;o>r;){var a=r+o>>>1;n.call(i,t[a])<s?r=a+1:o=a}return r},I.toArray=function(t){return t?I.isArray(t)?a.call(t):t.length===+t.length?I.map(t,I.identity):I.values(t):[]},I.size=function(t){return null==t?0:t.length===+t.length?t.length:I.keys(t).length},I.first=I.head=I.take=function(t,e,n){return null==t?void 0:null==e||n?t[0]:0>e?[]:a.call(t,0,e)},I.initial=function(t,e,n){return a.call(t,0,t.length-(null==e||n?1:e))},I.last=function(t,e,n){return null==t?void 0:null==e||n?t[t.length-1]:a.call(t,Math.max(t.length-e,0))},I.rest=I.tail=I.drop=function(t,e,n){return a.call(t,null==e||n?1:e)},I.compact=function(t){return I.filter(t,I.identity)};var D=function(t,e,n){return e&&I.every(t,I.isArray)?h.apply(n,t):(_(t,function(t){I.isArray(t)||I.isArguments(t)?e?o.apply(n,t):D(t,e,n):n.push(t)}),n)};I.flatten=function(t,e){return D(t,e,[])},I.without=function(t){return I.difference(t,a.call(arguments,1))},I.partition=function(t,e){var n=[],i=[];return _(t,function(t){(e(t)?n:i).push(t)}),[n,i]},I.uniq=I.unique=function(t,e,n,i){I.isFunction(e)&&(i=n,n=e,e=!1);var s=n?I.map(t,n,i):t,r=[],o=[];return _(s,function(n,i){(e?i&&o[o.length-1]===n:I.contains(o,n))||(o.push(n),r.push(t[i]))}),r},I.union=function(){return I.uniq(I.flatten(arguments,!0))},I.intersection=function(t){var e=a.call(arguments,1);return I.filter(I.uniq(t),function(t){return I.every(e,function(e){return I.contains(e,t)})})},I.difference=function(t){var e=h.apply(i,a.call(arguments,1));return I.filter(t,function(t){return!I.contains(e,t)})},I.zip=function(){for(var t=I.max(I.pluck(arguments,"length").concat(0)),e=new Array(t),n=0;t>n;n++)e[n]=I.pluck(arguments,""+n);return e},I.object=function(t,e){if(null==t)return{};for(var n={},i=0,s=t.length;s>i;i++)e?n[t[i]]=e[i]:n[t[i][0]]=t[i][1];return n},I.indexOf=function(t,e,n){if(null==t)return-1;var i=0,s=t.length;if(n){if("number"!=typeof n)return i=I.sortedIndex(t,e),t[i]===e?i:-1;i=0>n?Math.max(0,s+n):n}if(O&&t.indexOf===O)return t.indexOf(e,n);for(;s>i;i++)if(t[i]===e)return i;return-1},I.lastIndexOf=function(t,e,n){if(null==t)return-1;var i=null!=n;if(S&&t.lastIndexOf===S)return i?t.lastIndexOf(e,n):t.lastIndexOf(e);for(var s=i?n:t.length;s--;)if(t[s]===e)return s;return-1},I.range=function(t,e,n){arguments.length<=1&&(e=t||0,t=0),n=arguments[2]||1;for(var i=Math.max(Math.ceil((e-t)/n),0),s=0,r=new Array(i);i>s;)r[s++]=t,t+=n;return r};var H=function(){};I.bind=function(t,e){var n,i;if(g&&t.bind===g)return g.apply(t,a.call(arguments,1));if(!I.isFunction(t))throw new TypeError;return n=a.call(arguments,2),i=function(){if(!(this instanceof i))return t.apply(e,n.concat(a.call(arguments)));H.prototype=t.prototype;var s=new H;H.prototype=null;var r=t.apply(s,n.concat(a.call(arguments)));return Object(r)===r?r:s}},I.partial=function(t){var e=a.call(arguments,1);return function(){for(var n=0,i=e.slice(),s=0,r=i.length;r>s;s++)i[s]===I&&(i[s]=arguments[n++]);for(;n<arguments.length;)i.push(arguments[n++]);return t.apply(this,i)}},I.bindAll=function(t){var e=a.call(arguments,1);if(0===e.length)throw new Error("bindAll must be passed function names");return _(e,function(e){t[e]=I.bind(t[e],t)}),t},I.memoize=function(t,e){var n={};return e||(e=I.identity),function(){var i=e.apply(this,arguments);return I.has(n,i)?n[i]:n[i]=t.apply(this,arguments)}},I.delay=function(t,e){var n=a.call(arguments,2);return setTimeout(function(){return t.apply(null,n)},e)},I.defer=function(t){return I.delay.apply(I,[t,1].concat(a.call(arguments,1)))},I.throttle=function(t,e,n){var i,s,r,o=null,a=0;n||(n={});var h=function(){a=n.leading===!1?0:I.now(),o=null,r=t.apply(i,s),i=s=null
};return function(){var u=I.now();a||n.leading!==!1||(a=u);var c=e-(u-a);return i=this,s=arguments,0>=c?(clearTimeout(o),o=null,a=u,r=t.apply(i,s),i=s=null):o||n.trailing===!1||(o=setTimeout(h,c)),r}},I.debounce=function(t,e,n){var i,s,r,o,a,h=function(){var u=I.now()-o;e>u?i=setTimeout(h,e-u):(i=null,n||(a=t.apply(r,s),r=s=null))};return function(){r=this,s=arguments,o=I.now();var u=n&&!i;return i||(i=setTimeout(h,e)),u&&(a=t.apply(r,s),r=s=null),a}},I.once=function(t){var e,n=!1;return function(){return n?e:(n=!0,e=t.apply(this,arguments),t=null,e)}},I.wrap=function(t,e){return I.partial(e,t)},I.compose=function(){var t=arguments;return function(){for(var e=arguments,n=t.length-1;n>=0;n--)e=[t[n].apply(this,e)];return e[0]}},I.after=function(t,e){return function(){return--t<1?e.apply(this,arguments):void 0}},I.keys=function(t){if(!I.isObject(t))return[];if(m)return m(t);var e=[];for(var n in t)I.has(t,n)&&e.push(n);return e},I.values=function(t){for(var e=I.keys(t),n=e.length,i=new Array(n),s=0;n>s;s++)i[s]=t[e[s]];return i},I.pairs=function(t){for(var e=I.keys(t),n=e.length,i=new Array(n),s=0;n>s;s++)i[s]=[e[s],t[e[s]]];return i},I.invert=function(t){for(var e={},n=I.keys(t),i=0,s=n.length;s>i;i++)e[t[n[i]]]=n[i];return e},I.functions=I.methods=function(t){var e=[];for(var n in t)I.isFunction(t[n])&&e.push(n);return e.sort()},I.extend=function(t){return _(a.call(arguments,1),function(e){if(e)for(var n in e)t[n]=e[n]}),t},I.pick=function(t){var e={},n=h.apply(i,a.call(arguments,1));return _(n,function(n){n in t&&(e[n]=t[n])}),e},I.omit=function(t){var e={},n=h.apply(i,a.call(arguments,1));for(var s in t)I.contains(n,s)||(e[s]=t[s]);return e},I.defaults=function(t){return _(a.call(arguments,1),function(e){if(e)for(var n in e)void 0===t[n]&&(t[n]=e[n])}),t},I.clone=function(t){return I.isObject(t)?I.isArray(t)?t.slice():I.extend({},t):t},I.tap=function(t,e){return e(t),t};var L=function(t,e,n,i){if(t===e)return 0!==t||1/t==1/e;if(null==t||null==e)return t===e;t instanceof I&&(t=t._wrapped),e instanceof I&&(e=e._wrapped);var s=u.call(t);if(s!=u.call(e))return!1;switch(s){case"[object String]":return t==String(e);case"[object Number]":return t!=+t?e!=+e:0==t?1/t==1/e:t==+e;case"[object Date]":case"[object Boolean]":return+t==+e;case"[object RegExp]":return t.source==e.source&&t.global==e.global&&t.multiline==e.multiline&&t.ignoreCase==e.ignoreCase}if("object"!=typeof t||"object"!=typeof e)return!1;for(var r=n.length;r--;)if(n[r]==t)return i[r]==e;var o=t.constructor,a=e.constructor;if(o!==a&&!(I.isFunction(o)&&o instanceof o&&I.isFunction(a)&&a instanceof a)&&"constructor"in t&&"constructor"in e)return!1;n.push(t),i.push(e);var h=0,c=!0;if("[object Array]"==s){if(h=t.length,c=h==e.length)for(;h--&&(c=L(t[h],e[h],n,i)););}else{for(var l in t)if(I.has(t,l)&&(h++,!(c=I.has(e,l)&&L(t[l],e[l],n,i))))break;if(c){for(l in e)if(I.has(e,l)&&!h--)break;c=!h}}return n.pop(),i.pop(),c};I.isEqual=function(t,e){return L(t,e,[],[])},I.isEmpty=function(t){if(null==t)return!0;if(I.isArray(t)||I.isString(t))return 0===t.length;for(var e in t)if(I.has(t,e))return!1;return!0},I.isElement=function(t){return!(!t||1!==t.nodeType)},I.isArray=R||function(t){return"[object Array]"==u.call(t)},I.isObject=function(t){return t===Object(t)},_(["Arguments","Function","String","Number","Date","RegExp"],function(t){I["is"+t]=function(e){return u.call(e)=="[object "+t+"]"}}),I.isArguments(arguments)||(I.isArguments=function(t){return!(!t||!I.has(t,"callee"))}),"function"!=typeof/./&&(I.isFunction=function(t){return"function"==typeof t}),I.isFinite=function(t){return isFinite(t)&&!isNaN(parseFloat(t))},I.isNaN=function(t){return I.isNumber(t)&&t!=+t},I.isBoolean=function(t){return t===!0||t===!1||"[object Boolean]"==u.call(t)},I.isNull=function(t){return null===t},I.isUndefined=function(t){return void 0===t},I.has=function(t,e){return c.call(t,e)},I.noConflict=function(){return t._=e,this},I.identity=function(t){return t},I.constant=function(t){return function(){return t}},I.property=function(t){return function(e){return e[t]}},I.matches=function(t){return function(e){if(e===t)return!0;for(var n in t)if(t[n]!==e[n])return!1;return!0}},I.times=function(t,e,n){for(var i=Array(Math.max(0,t)),s=0;t>s;s++)i[s]=e.call(n,s);return i},I.random=function(t,e){return null==e&&(e=t,t=0),t+Math.floor(Math.random()*(e-t+1))},I.now=Date.now||function(){return(new Date).getTime()};var P={escape:{"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;"}};P.unescape=I.invert(P.escape);var M={escape:new RegExp("["+I.keys(P.escape).join("")+"]","g"),unescape:new RegExp("("+I.keys(P.unescape).join("|")+")","g")};I.each(["escape","unescape"],function(t){I[t]=function(e){return null==e?"":(""+e).replace(M[t],function(e){return P[t][e]})}}),I.result=function(t,e){if(null==t)return void 0;var n=t[e];return I.isFunction(n)?n.call(t):n},I.mixin=function(t){_(I.functions(t),function(e){var n=I[e]=t[e];I.prototype[e]=function(){var t=[this._wrapped];return o.apply(t,arguments),x.call(this,n.apply(I,t))}})};var F=0;I.uniqueId=function(t){var e=++F+"";return t?t+e:e},I.templateSettings={evaluate:/<%([\s\S]+?)%>/g,interpolate:/<%=([\s\S]+?)%>/g,escape:/<%-([\s\S]+?)%>/g};var Y=/(.)^/,U={"'":"'","\\":"\\","\r":"r","\n":"n","	":"t","\u2028":"u2028","\u2029":"u2029"},b=/\\|'|\r|\n|\t|\u2028|\u2029/g;I.template=function(t,e,n){var i;n=I.defaults({},n,I.templateSettings);var s=new RegExp([(n.escape||Y).source,(n.interpolate||Y).source,(n.evaluate||Y).source].join("|")+"|$","g"),r=0,o="__p+='";t.replace(s,function(e,n,i,s,a){return o+=t.slice(r,a).replace(b,function(t){return"\\"+U[t]}),n&&(o+="'+\n((__t=("+n+"))==null?'':_.escape(__t))+\n'"),i&&(o+="'+\n((__t=("+i+"))==null?'':__t)+\n'"),s&&(o+="';\n"+s+"\n__p+='"),r=a+e.length,e}),o+="';\n",n.variable||(o="with(obj||{}){\n"+o+"}\n"),o="var __t,__p='',__j=Array.prototype.join,print=function(){__p+=__j.call(arguments,'');};\n"+o+"return __p;\n";try{i=new Function(n.variable||"obj","_",o)}catch(a){throw a.source=o,a}if(e)return i(e,I);var h=function(t){return i.call(this,t,I)};return h.source="function("+(n.variable||"obj")+"){\n"+o+"}",h},I.chain=function(t){return I(t).chain()};var x=function(t){return this._chain?I(t).chain():t};I.mixin(I),_(["pop","push","reverse","shift","sort","splice","unshift"],function(t){var e=i[t];I.prototype[t]=function(){var n=this._wrapped;return e.apply(n,arguments),"shift"!=t&&"splice"!=t||0!==n.length||delete n[0],x.call(this,n)}}),_(["concat","join","slice"],function(t){var e=i[t];I.prototype[t]=function(){return x.call(this,e.apply(this._wrapped,arguments))}}),I.extend(I.prototype,{chain:function(){return this._chain=!0,this},value:function(){return this._wrapped}}),"function"==typeof define&&define.amd&&define("underscore",[],function(){return I})}.call(this),function(t,e){"object"==typeof module&&module.exports?module.exports=function(t){return t=t||require("underscore"),e(t)}:"function"==typeof define&&define.amd?define(["underscore"],function(n){return e(n,t)}):t.machina=e(t._,t)}(this,function(t,e,n){var i=[].slice,s="transition",r="handler",o="handling",a="handled",h="nohandler",u="transition",c="invalidstate",l="deferred",p="newfsm",E={makeFsmNamespace:function(){var t=0;return function(){return"fsm."+t++}}(),getDefaultOptions:function(){return{initialState:"uninitialized",eventListeners:{"*":[]},states:{},eventQueue:[],namespace:E.makeFsmNamespace(),targetReplayState:"",state:n,priorState:n,_priorAction:"",_currentAction:""}}};if(!t.deepExtend){var d={"*":function(t,e,n){t[e]=n},object:function(t,e,n){t[e]=A({},t[e]||{},n)},array:function(e,n,i){e[n]=[],t.each(i,function(t,i){d[T(t)](e[n],i,t)},this)}},f=function(e){return t.isArray(e)?"array":t.isDate(e)?"date":t.isRegExp(e)?"regex":typeof e},T=function(t){var e=f(t);return d[e]?e:"*"},A=function(e){return t.each(i.call(arguments,1),function(n){t.each(n,function(t,n){d[T(t)](e,n,t)})}),e};t.mixin({deepExtend:A})}var O=function(e){t.extend(this,e),t.defaults(this,E.getDefaultOptions()),this.initialize.apply(this,arguments),m.emit(p,this),this.initialState&&this.transition(this.initialState)};t.extend(O.prototype,{initialize:function(){},emit:function(e){var n=arguments;this.eventListeners["*"]&&t.each(this.eventListeners["*"],function(t){try{t.apply(this,i.call(n,0))}catch(e){console&&"undefined"!=typeof console.log&&console.log(e.toString())}},this),this.eventListeners[e]&&t.each(this.eventListeners[e],function(t){try{t.apply(this,i.call(n,1))}catch(e){console&&"undefined"!=typeof console.log&&console.log(e.toString())}},this)},handle:function(e){if(!this.inExitHandler){var s,u,c,l,p=this.states,E=this.state,d=i.call(arguments,0);this.currentActionArgs=d,p[E][e]||p[E]["*"]||this["*"]?(s=p[E][e]?e:"*",c="*"===s,p[E][s]?(u=p[E][s],l=E+"."+s):(u=this["*"],l="*"),this._currentAction||(this._currentAction=l),this.emit.call(this,o,{inputType:e,args:d.slice(1)}),t.isFunction(u)&&(u=u.apply(this,c?d:d.slice(1))),t.isString(u)&&this.transition(u),this.emit.call(this,a,{inputType:e,args:d.slice(1)}),this._priorAction=this._currentAction,this._currentAction="",this.processQueue(r)):this.emit.call(this,h,{inputType:e,args:d.slice(1)}),this.currentActionArgs=n}},transition:function(t){if(!this.inExitHandler&&t!==this.state){var e=this.state;if(this.states[t])return this.states[e]&&this.states[e]._onExit&&(this.inExitHandler=!0,this.states[e]._onExit.call(this),this.inExitHandler=!1),this.targetReplayState=t,this.priorState=e,this.state=t,this.emit.call(this,u,{fromState:this.priorState,action:this._currentAction,toState:t}),this.states[t]._onEnter&&this.states[t]._onEnter.call(this),void(this.targetReplayState===t&&this.processQueue(s));this.emit.call(this,c,{state:this.state,attemptedState:t})}},processQueue:function(e){var n=e===s?function(t){return t.type===s&&(!t.untilState||t.untilState===this.state)}:function(t){return t.type===r},i=t.filter(this.eventQueue,n,this);this.eventQueue=t.difference(this.eventQueue,i),t.each(i,function(t){this.handle.apply(this,t.args)},this)},clearQueue:function(e,n){if(e){var i;e===s?i=function(t){return t.type===s&&(n?t.untilState===n:!0)}:e===r&&(i=function(t){return t.type===r}),this.eventQueue=t.filter(this.eventQueue,i)}else this.eventQueue=[]},deferUntilTransition:function(t){if(this.currentActionArgs){var e={type:s,untilState:t,args:this.currentActionArgs};this.eventQueue.push(e),this.emit.call(this,l,{state:this.state,queuedArgs:e})}},deferUntilNextHandler:function(){if(this.currentActionArgs){var t={type:r,args:this.currentActionArgs};this.eventQueue.push(t),this.emit.call(this,l,{state:this.state,queuedArgs:t})}},on:function(t,e){var n=this;return n.eventListeners[t]||(n.eventListeners[t]=[]),n.eventListeners[t].push(e),{eventName:t,callback:e,off:function(){n.off(t,e)}}},off:function(e,n){e?this.eventListeners[e]&&(this.eventListeners[e]=n?t.without(this.eventListeners[e],n):[]):this.eventListeners={}}}),O.prototype.trigger=O.prototype.emit;var S=function(){},R=function(e,n,i){var s;return s=n&&n.hasOwnProperty("constructor")?n.constructor:function(){e.apply(this,arguments)},t.deepExtend(s,e),S.prototype=e.prototype,s.prototype=new S,n&&t.deepExtend(s.prototype,n),i&&t.deepExtend(s,i),s.prototype.constructor=s,s.__super__=e.prototype,s};O.extend=function(t,e){var n=R(this,t,e);return n.extend=this.extend,n};var m={Fsm:O,utils:E,on:function(t,e){return this.eventListeners[t]||(this.eventListeners[t]=[]),this.eventListeners[t].push(e),e},off:function(e,n){this.eventListeners[e]&&(this.eventListeners[e]=t.without(this.eventListeners[e],n))},trigger:function(e){var n=arguments,s=this.eventListeners[e]||[];s&&s.length&&t.each(s,function(t){t.apply(null,i.call(n,1))})},eventListeners:{newFsm:[]}};return m.emit=m.trigger,m}),function(t){function e(){var t=arguments[0],n=e.cache;return n[t]&&n.hasOwnProperty(t)||(n[t]=e.parse(t)),e.format.call(null,n[t],arguments)}function n(t){return Object.prototype.toString.call(t).slice(8,-1).toLowerCase()}function i(t,e){return Array(e+1).join(t)}var s={not_string:/[^s]/,number:/[def]/,text:/^[^\x25]+/,modulo:/^\x25{2}/,placeholder:/^\x25(?:([1-9]\d*)\$|\(([^\)]+)\))?(\+)?(0|'[^$])?(-)?(\d+)?(?:\.(\d+))?([b-fosuxX])/,key:/^([a-z_][a-z_\d]*)/i,key_access:/^\.([a-z_][a-z_\d]*)/i,index_access:/^\[(\d+)\]/,sign:/^[\+\-]/};e.format=function(t,r){var o,a,h,u,c,l,p,E=1,d=t.length,f="",T=[],A=!0,O="";for(a=0;d>a;a++)if(f=n(t[a]),"string"===f)T[T.length]=t[a];else if("array"===f){if(u=t[a],u[2])for(o=r[E],h=0;h<u[2].length;h++){if(!o.hasOwnProperty(u[2][h]))throw new Error(e("[sprintf] property '%s' does not exist",u[2][h]));o=o[u[2][h]]}else o=u[1]?r[u[1]]:r[E++];if("function"==n(o)&&(o=o()),s.not_string.test(u[8])&&"number"!=n(o)&&isNaN(o))throw new TypeError(e("[sprintf] expecting number but found %s",n(o)));switch(s.number.test(u[8])&&(A=o>=0),u[8]){case"b":o=o.toString(2);break;case"c":o=String.fromCharCode(o);break;case"d":o=parseInt(o,10);break;case"e":o=u[7]?o.toExponential(u[7]):o.toExponential();break;case"f":o=u[7]?parseFloat(o).toFixed(u[7]):parseFloat(o);break;case"o":o=o.toString(8);break;case"s":o=(o=String(o))&&u[7]?o.substring(0,u[7]):o;break;case"u":o>>>=0;break;case"x":o=o.toString(16);break;case"X":o=o.toString(16).toUpperCase()}(!A||s.number.test(u[8])&&u[3])&&(O=A?"+":"-",o=o.toString().replace(s.sign,"")),l=u[4]?"0"==u[4]?"0":u[4].charAt(1):" ",p=u[6]-(O+o).length,c=u[6]?i(l,p):"",T[T.length]=u[5]?O+o+c:0==l?O+c+o:c+O+o}return T.join("")},e.cache={},e.parse=function(t){for(var e=t,n=[],i=[],r=0;e;){if(null!==(n=s.text.exec(e)))i[i.length]=n[0];else if(null!==(n=s.modulo.exec(e)))i[i.length]="%";else{if(null===(n=s.placeholder.exec(e)))throw new SyntaxError("[sprintf] unexpected placeholder");if(n[2]){r|=1;var o=[],a=n[2],h=[];if(null===(h=s.key.exec(a)))throw new SyntaxError("[sprintf] failed to parse named argument key");for(o[o.length]=h[1];""!==(a=a.substring(h[0].length));)if(null!==(h=s.key_access.exec(a)))o[o.length]=h[1];else{if(null===(h=s.index_access.exec(a)))throw new SyntaxError("[sprintf] failed to parse named argument key");o[o.length]=h[1]}n[2]=o}else r|=2;if(3===r)throw new Error("[sprintf] mixing positional and named placeholders is not (yet) supported");i[i.length]=n}e=e.substring(n[0].length)}return i};var r=function(t,n,i){return i=(n||[]).slice(0),i.splice(0,0,t),e.apply(null,i)};"undefined"!=typeof exports?(exports.sprintf=e,exports.vsprintf=r):(t.sprintf=e,t.vsprintf=r,"function"==typeof define&&define.amd&&define(function(){return{sprintf:e,vsprintf:r}}))}("undefined"==typeof window?this:window),function(){!function(t,e){t(function(){var n,i,s;i=new machina.Fsm({initialState:"startGame",WEEDING_EFFECTS:{0:[.75,0,0],1:[1,86,0],2:[1.05,60,0],3:[1.15,8,95],11:[1.15,144,0],12:[1.15,146,0],13:[1.2,83,95],21:[1.15,165,0],22:[1.15,125,0],23:[1.2,125,95],31:[1.2,83,95],32:[1.2,83,95],33:[1.25,16,180]},VALID_WEEDING:function(){return e.keys(this.WEEDING_EFFECTS).join(",")},SEEDBED_PREP_HOURS:24,TRACTOR_HOURS:32,CARABAO_HOURS:72,TRACTOR_RATE:45,CARABAO_RATE:25,FMT:"%-31s     %9.2f",FMT2:"    %-31s %9.2f",data:{runCount:1,costs:{irrigation:945,landTax:1015},hours:{transplanting:144},snailAttacks:0,fertNContent:function(){return.45*this.fertApplRate},seedYield:function(){return"LOCAL"===this.seedType?1920:2250},ureaFactor1:function(){return"LOCAL"===this.seedType?-26e-5:-15e-5},ureaFactor2:function(){return"LOCAL"===this.seedType?.023:.032}},totalCosts:function(t){var e;return null==(e=this.data.costs)[t]&&(e[t]=0),this.data.costs[t]*this.data.farmSize},labor:function(t){var e;return null==(e=this.data.hours)[t]&&(e[t]=0),this.data.farmSize*this.data.wages/8*this.data.hours[t]},states:{startGame:{input:function(t){var e;e=this.getYesNo(t),this.errorFlag||(this.data.skipIntro=e,this.transition(e?"mainIntro":"intro1"))}},intro1:{_onEnter:function(){this.message="\n\nWelcome to the real world!  YOU ARE TO PLAY THE ROLE OF A\n   SMALL-TIME RICE FARMER IN THE PHILIPPINES.  YOU HAVE\n   CONTROL OVER MOST OF THE FACTORS WHICH INFLUENCE YOUR\n   OUTPUT.  THE IDEA IS TO RAISE SEVERAL SUCCESSIVE CROPS,\n   ALWAYS TRYING TO INCREASE YOUR RETURNS TO LABOR AND\n   CAPITAL. A FAILURE FOR A SINGLE YEAR MAY MEAN A MAJOR\n   CRISIS FOR YOU AND FOR THE FAMILY.  GOOD LUCK!!!\n\n\n\nYOU ARE A NEW OWNER AS A RESULT OF LAND REFORM.\nYOUR LAND IS IRRIGATED.\nYOUR HEADMAN WOULD LIKE YOU TO RAISE 'IR64' WHICH IS SAID TO\nACHIEVE VERY HIGH YIELDS, BUT YOU ARE FAMILIAR WITH 'LOCAL' RICE\nAND HESITATE TO EXPERIMENT WITH NEW KINDS OF SEEDS.\n"+this.waitText},input:function(){this.transition("intro2")}},intro2:{_onEnter:function(){this.message="\n\n\n    FIRST, A FEW TERMS YOU SHOULD KNOW:\n      HECTARE (HA.) = 10,000 SQ. METERS (2.47 ACRES)\n      KILOGRAM (KG.) = 2.2 POUNDS\n      PESO = U.S. $0.023 ($1 = 44 PESOS)\n      CAVAN = VOLUME MEASURE - ROUGHLY 50 KG. OF PALAY\n      PALAY = THE TERM FOR THRESHED BUT UNHUSKED RICE\n      IR64 = A HIGH YIELDING RICE VARIETY FIRST RELEASED IN 1985\n      LODGING = PLANT FALLS OVER FROM TOO WEAK STEM.\n"+this.waitText},input:function(){this.transition("factors1")}},factors1:{_onEnter:function(){this.message="\n\nFactors you can control include (among others) the following 10:\n\n     1. SIZE OF FARM (IN HECTARES).\n  THE MEAN FARM SIZE IN CENTRAL LUZON IS ABOUT 1.8 HA. BUT\n  SOME FARMS ARE A FRACTION OF A HA. WHILE OTHERS ARE AS\n  LARGE AS 50 HECTARES.\n  \n     2. COSTS OF OUTSIDE LABOR (IN PESOS/DAY).\n  LABOR COSTS PER DAY FOR FARM WORK (1998) VARY FROM PESOS\n  105 TO PESOS 125 DEPENDING ON LOCATION AND SEASON. SOME\n  SMALL SNACK FOODS ARE NORMALLY ADDED TO THIS COST.\n  \n     3. TYPE OF RICE (SEED) USED.\n  IR64 HAS GREAT POTENTIAL, BUT MOST FARMERS ARE FAMILIAR\n  WITH LOCAL VARIETIES.\n  "+this.waitText},input:function(){this.transition("factors2")}},factors2:{_onEnter:function(){this.message="\n     4. COST OF SEED.\n  SEEDS ARE USED AT THE RATE OF 1 CAVAN PER HA. OF FARM.\n  ORDINARY HYV SEED COSTS 570 - 630 PESOS PER CAVAN.\n  GOVERNMENT INSPECTED SEED OF VERY GOOD QUALITY SELLS AT \n  ABOUT 675 PESOS. SOMETIMES A FARMER WITH SURPLUS RICE\n  WILL OFFER A 'DEAL' - SEED FOR much LOWER COST. SOME\n  SHARP BUSINESS TYPES MAY OFFER 'SELECTED' SEED FOR AS\n  MUCH AS 700 - 750 PESOS.\n\n  LET'S ASSUME THAT OUR FARMER USES A VERY EFFICIENT SEED\n  RATE OF ONE CAVAN PER HECTARE!\n"+this.waitText},input:function(){this.transition("factors3")}},factors3:{_onEnter:function(){this.message="\n     5. USE OF SYSTEMIC PESTICIDE, I.P.M., OR NOTHING.\n  I.P.M. (OR INTEGRATED PEST MANAGEMENT) INVOLVES CAREFUL\n  CULTIVATION TECHNIQUES, THE ENCOURAGEMENT OF RICE PEST PREDATORS,\n  AND CONSTANT MONITORING OF PEST INFESTATIONS. IF THESE EXCEED\n  ACCEPTABLE LEVELS THEN A LIMITED SPRAY PROGRAM IS UNDERTAKEN.\n    SYSTEMIC PESTICIDES ARE DESIGNED TO RID YOUR FIELDS OF\n  INSECTS. THIS OFTEN INCLUDES PEST PREDATORS AS WELL AS STEM-\n  BORERS, ARMY WORMS AND LEAF HOPPERS.\n    SYSTEMICS ARE APPLIED AT TRANSPLANTING. (THIS IS WELL BEFORE\n  ANY INSECT ATTACK WILL BE OBSERVED). SYSTEMICS ARE COSTLY\n  BUT EFFECTIVE IN CUTTING LOSS FROM MANY INSECTS. MOST\n  FARMERS GAMBLE ON A LIGHT ATTACK AND DON'T USE SYSTEMICS.\n"+this.waitText},input:function(){this.transition("factors4")}},factors4:{_onEnter:function(){this.message="\n     6. COST AND AMOUNT OF NITROGEN FERTILIZER.\n  UREA IS THE CHEAPEST FORM OF NITROGEN. BY WEIGHT IT HAS\n  45 PERCENT N. A BAG OF UREA WEIGHS 50 KG.; AND COSTS BETWEEN\n  PESOS 350 - 370 (1998).\n\n     7. METHOD OF CROPLAND PREPARATION.\n  USE OF THE CARABAO IS TRADITIONAL, BUT MANY FARMERS TODAY\n  ARE HAVING THEIR FIELDS CUSTOM PLOWED BY SMALL TRACTOR.\n  ADVANTAGES OF THIS ARE SPEED AND BETTER WEED CONTROL.\n\n     8. METHOD OF WEEDING AND HERBICIDE APPLICATIONS.\n  WEEDING TOO HAS TRADITIONALLY BEEN DONE BY HAND.\n  THE USE OF HERBICIDES IS A RECENT INNOVATION.\n"+this.waitText},input:function(){this.transition("factors5")}},factors5:{_onEnter:function(){this.message="\n     9. METHOD OF THRESHING.\n  WITH INCREASED YIELDS MANY FARMERS ARE HIRING CUSTOM MACHINE\n  THRESHING RATHER THAN STICKING WITH THE OLD HAND METHOD.\n\n     10. MARKET VALUE OF ROUGH RICE.\n  VARIES WITH VARIETY, QUALITY AND SEASON. AVERAGES (1994)\n  ABOUT 312 PESOS PER CAVAN (6.25 PESOS PER KG.)\n  MILLING RATE IS ROUGHLY 64% (50 KG. OF PALAY YIELDS\n  32 KG. OF RICE).  RETAIL PRICE OF RICE AVERAGED\n  (1994) 10.75 PESOS PER KG.\n"+this.waitText},input:function(){this.transition("mainIntro")}},mainIntro:{_onEnter:function(){this.message="\n\n  FOR YOUR FIRST CROP YOU MUST MAKE ALL THE DECISIONS BASED\n  ON THE INFORMATION GIVEN IN THE INITIAL INTRODUCTION\n  AND INSTRUCTIONS.\n\n  This is the WET season and you have IRRIGATION.\n"+this.waitText},input:function(){this.transition("setFarmSize")}},setFarmSize:{_onEnter:function(){this.errorFlag||(this.message="\nWhat is the size of your farm (IN HECTARES)?\n")},input:function(t){this.data.farmSize=this.getNumber(this.data.farmSize,t),this.errorFlag||(this.message=this.data.farmSize>=5?"THAT'S PRETTY LARGE FOR A PEASANT IN LUZON.":"",this.transition(this.data.runCount>1?"startProcessing":"setWages"))}},setWages:{_onEnter:function(){this.message+="\nWHAT IS THE COST OF OUTSIDE LABOR IN PESOS PER DAY?\n"},input:function(t){this.data.wages=this.getNumber(this.data.wages,t),this.errorFlag||(this.message=this.data.wages<=100?"Those are terrible wages - you cheapskate!!!\n":this.data.wages>139?"Very high wages - I doubt you can afford them\n":"",this.transition(this.data.runCount>1?"startProcessing":"setSeedType"))}},setSeedType:{_onEnter:function(){this.message+="\nIS 'LOCAL' OR 'IR64' RICE TO BE PLANTED?\n"},input:function(t){this.data.seedType=this.getResponse("LOCAL,IR64",this.data.seedType,t),this.errorFlag||this.transition(this.data.runCount>1?"startProcessing":"setSeedCost")}},setSeedCost:{_onEnter:function(){this.message="\nWHAT IS THE COST OF SEED IN PESOS/HA?\n"},input:function(t){this.data.costs.seeds=this.getNumber(this.data.costs.seeds,t),this.errorFlag||(this.data.costs.seeds>680?(this.message="expensive seed - it may not be good - too old\n",this.data.seedDefectFactor=.9):this.data.costs.seeds<=560?(this.message="cheap seed - why waste time with it - poor germination\n",this.data.seedDefectFactor=.9):(this.message="",this.data.seedDefectFactor=1),this.transition(this.data.runCount>1?"startProcessing":"setPesticide"))}},setPesticide:{_onEnter:function(){this.message+="\nDO YOU WISH TO APPLY SYSTEMIC PESTICIDE? 'YES' OR 'NO'\n"},input:function(t){var e;e=this.getYesNo(t),this.errorFlag||(e?(this.data.pesticideYieldFactor=1.15,this.data.costs.earlyPestControl=390,this.data.hours.earlyPestControl=12,this.transition(this.data.runCount>1?"startProcessing":"setFertilizer")):(this.data.costs.earlyPestControl=0,this.data.hours.earlyPestControl=0,this.transition("setIPM")))}},setIPM:{_onEnter:function(){this.message="\nDO YOU WISH TO USE I.P.M.? 'YES' OR 'NO'\n"},input:function(t){var e;e=this.getYesNo(t),this.errorFlag||(e?(this.data.pesticideYieldFactor=1.15,this.data.costs.early_pest_control=390,this.data.hours.early_pest_control=12):this.data.pesticideYieldFactor=1,this.transition(this.data.runCount>1?"startProcessing":"setFertilizer"))}},setFertilizer:{_onEnter:function(){this.message="\nFOR NITROGEN FERTILIZER (UREA):\n     1. WHAT IS YOUR RATE OF APPLICATION? (KG./HA.)\n"},input:function(t){this.data.fertApplRate=this.getNumber(this.data.fertApplRate,t),this.errorFlag||(this.data.fertApplRate<=0?(this.data.fertApplRate=0,this.transition("setLandPrep")):(this.message=this.data.fertApplRate>400?"\n"+this.data.fertApplRate+" KG. OF UREA CONTAINS "+this.data.fertNContent()+" KG. OF NITROGEN.\nYOUR CROP CAN NOT USE THAT MUCH.  YOU MAY CAUSE SOME\nDAMAGE TO THE ECOSYSTEMS IN NEARBY STREAMS.  AT THE\nVERY LEAST, YOU HAVE WASTED MANY PESOS.\n\n":"\n",this.transition("setFertilizer2")))}},setFertilizer2:{_onEnter:function(){this.message+="     2. WHAT IS THE COST OF UREA (PESOS/KG.)\n"},input:function(t){this.data.fertCost=this.getNumber(this.data.fertCost,t),this.errorFlag||(this.data.fertCost<=6.8?this.message="You can not buy it so CHEAPLY - PLEASE REPEAT\n":this.data.fertCost>7.4?this.message="THAT IS EXPENSIVE FERTILIZER - PLEASE REPEAT\n":(this.data.costs.fertilizer=this.data.fertApplRate*this.data.fertCost,this.data.hours.fertilizer=8*(1.5+this.data.fertApplRate/50),this.transition(this.data.runCount>1?"startProcessing":"setLandPrep")))}},setLandPrep:{_onEnter:function(){this.data.costs.seedbedPrep=this.data.hours.seedbedPrep=this.data.costs.landPrep=this.data.hours.landPrep=0,this.message="\ndo you plan to use 'CARABAO' (WATER BUFFALO) or 'TRACTOR'\nfor cropland preparation\n"},input:function(t){this.data.prepMethod=this.getResponse("CARABAO,TRACTOR",this.data.prepMethod,t),this.errorFlag||("CARABAO"===this.data.prepMethod?this.transition("setCarabaoOwnership"):(this.data.ownOrHire="HIRE",this.message="\nTHE CURRENT RATE FOR HIRED TRACTOR PLUS DRIVER IS\n"+this.TRACTOR_RATE+" PESOS/HOUR.\n",this.data.costs.seedbedPrep=this.CARABAO_RATE*this.SEEDBED_PREP_HOURS,this.data.costs.landPrep=this.TRACTOR_RATE*this.TRACTOR_HOURS,this.transition(this.data.runCount>1?"startProcessing":"setWeeding")))}},setCarabaoOwnership:{_onEnter:function(){this.message="\ndo you 'OWN' or will you 'HIRE' the carabao\n"},input:function(t){this.data.ownOrHire=this.getResponse("OWN,HIRE",this.data.ownOrHire,t),this.errorFlag||("HIRE"===this.data.ownOrHire?(this.message="\nTHE CURRENT RATE FOR CARABAO PLUS HANDLER IS "+this.CARABAO_RATE+" PESOS/\nHOUR.\n",this.data.costs.seedbedPrep=this.CARABAO_RATE*this.SEEDBED_PREP_HOURS,this.data.costs.landPrep=this.CARABAO_RATE*this.CARABAO_HOURS):(this.data.hours.seedbedPrep=this.SEEDBED_PREP_HOURS,this.data.costs.landPrep=2/6*(this.SEEDBED_PREP_HOURS+this.CARABAO_HOURS),this.data.hours.landPrep=this.CARABAO_HOURS),this.transition(this.data.runCount>1?"startProcessing":"setWeeding"))}},setWeeding:{_onEnter:function(){this.message+="\nThere are three weeding methods available\n     1. HAND WEEDING.\n     2. ROTARY HAND WEEDER.\n     3. GRANULAR HERBICIDE (2,4-D ISOPROPYL ESTER)\n\nTHESE METHODS MAY BE EMPLOYED EITHER SINGLY OR IN\nCOMBINATION WITH ONE OTHER METHOD. WHEN REQUESTED,\nENTER NUMBERS CORRESPONDING TO THE METHODS ABOVE,\nFOR INSTANCE '2' MEANS ONE ROTARY WEEDING, '32' MEANS\n2,4-D FOLLOWED BY A ROTARY WEEDING, AND '11' MEANS\n2 HAND WEEDINGS.\n"+this.waitText},input:function(){this.transition("setWeeding2")}},setWeeding2:{_onEnter:function(){this.message="\nPlease note the following:\n   A. WEEDS COMPETE VIGOROUSLY WITH RICE AND LOWER\n      THE POTENTIAL YIELD.\n   B. WHEN A HAND WEEDING IS DONE IN COMBINATION WITH\n      ANOTHER METHOD, THE HAND WEEDING IS USUALLY DONE\n      LAST (I.E. '31', NOT '13'!)\n   C. if YOU DESIRE NO WEEDING, ENTER 0 (ZERO).\n\nWhat weeding method(s) do you wish to use\n"},input:function(t){this.data.weedingMethod=this.getResponse(this.VALID_WEEDING(),this.data.weedingMethod,t),this.errorFlag||(this.data.costs.weeding=this.WEEDING_EFFECTS[this.data.weedingMethod][2],this.data.hours.weeding=this.WEEDING_EFFECTS[this.data.weedingMethod][1],this.transition("setMolluscicide"))}},setMolluscicide:{_onEnter:function(){this.snailAttacks++,this.message="\nOh my goodness! DURING THE WEED SURVEY MANY BRIGHT RED EGG\nMASSES OF THE GOLDEN SNAIL WERE SEEN IN YOUR FIELDS. If you wish\nyou may spray MOLLUSCICIDE or remove the snails and eggs by\nhand. You may also choose to do nothing.\n\nDO YOU WISH TO SPRAY A MOLLUSCICIDE?\n"},input:function(t){var e;e=this.getYesNo(t),this.errorFlag||(e?(this.data.snailAttacks=0,this.data.costs.molluscicide=315,this.data.hours.molluscicide=18,this.transition("setWeedingStart")):this.transition("setHandPickSnails"))}},setHandPickSnails:{_onEnter:function(){this.snailAttacks++,this.message="\nDO YOU WISH TO HAND PICK YOUR FIELDS?\n"},input:function(t){var e;e=this.getYesNo(t),this.errorFlag||(e&&(this.snailAttacks=0,this.data.costs.molluscicide=0,this.data.hours.molluscicide=60),this.transition("setWeedingStart"))}},setWeedingStart:{_onEnter:function(){this.message="\nHOW MANY DAYS AFTER TRANSPLANTING IS THE WEEDING\nOPERATION STARTED\n"},input:function(t){this.data.weedingDaysStart=this.getNumber(this.data.weedingDaysStart,t),this.errorFlag||this.data.runCount>1||this.transition("setThreshing"),this.data.runCount>1&&this.transition("startProcessing")}},setThreshing:{_onEnter:function(){this.message="\nIs the threshing to be done by 'HAND' or by 'MACHINE'\n"},input:function(t){this.data.threshingMethod=this.getResponse("HAND,MACHINE",this.data.threshingMethod,t),this.errorFlag||this.data.runCount>1||this.transition("setMarketValue"),this.data.runCount>1&&this.transition("startProcessing")}},setMarketValue:{_onEnter:function(){this.message="\nWhat is the market value of ROUGH RICE (PESOS/KG.)\n"},input:function(t){this.data.price=this.getNumber(this.data.price,t),this.errorFlag||(this.data.price>6.35?this.message="\nTHAT'S WAY ABOVE THE LATEST REPORTED MARKET PRICE.\nPLEASE REPEAT THE PRICE PER KILOGRAM.\n":this.transition("startProcessing"))}},startProcessing:{_onEnter:function(){var t;this.data.riceYield=this.data.pesticideYieldFactor*this.data.seedDefectFactor*this.WEEDING_EFFECTS[this.data.weedingMethod][0]*(this.data.ureaFactor1()*Math.pow(this.data.fertNContent(),2)+this.data.ureaFactor2()*this.data.fertNContent()+1)*this.data.seedYield(),this.data.riceYield<0&&(this.data.riceYield=0),this.message="\n\n\nrandomizing events...\n    calculating costs and yields... DONE! \n\n","TRACTOR"===this.data.prepMethod&&(this.data.riceYield*=1.07,this.message+="\nYOU DID A BEAUTIfUL JOB PREPARING THE FIELDS.\n"),this.data.weedingDaysStart>=20?(this.message+="\nYOU WAITED TOO LONG TO START THE WEEDING. YOU HAVE \nWASTED YOUR TIME AND YOUR LABOR.  TOUGH LUCK!\n",this.data.riceYield*=.7):this.data.weedingDaysStart>=14&&(this.message+="\nYOU HAVE WAITED SO LONG TO START THE WEEDING THAT IT IS\nONLY PARTLY SUCCESSFUL.  BETTER LUCK NEXT TIME.\n",this.data.riceYield*=.85),this.message+="\n","IR64"===this.data.seedType?(t=Math.floor(4*Math.random())/100,this.message+="LOOKS AS if BACTERIAL BLIGHT AND BLAST HAVE CAUSED ABOUT\n"):(t=Math.floor(13*Math.random())/100,this.message+="UNFORTUNATELY, GRASSY STUNT AND TUNGRO HAVE CAUSED ABOUT\n"),this.message+=""+100*t+" PERCENT LOSS OF POTENTIAL YIELD.\n",this.data.riceYield*=1-t,this.message+="\nA VERY STRONG TYPHOON IS REPORTED HEADED TOWARD YOUR AREA\nFROM THE SOUTH-EAST. TIE DOWN YOUR HOUSE AND PRAY THAT THE\nSTORM MISSES YOUR FARM.\n\n\nWhat is YOUR prayer?\n"},input:function(){this.transition("processing2")}},processing2:{_onEnter:function(){var t;this.message="",this.data.snailAttacks>=1&&(this.message+="\nYou didn't get rid of the snails last year. Too bad - they have\ndestroyed MANY plants this year. Better try escargot with garlic.\n",t=Math.floor(12+6*Math.random()),this.data.riceYield*=1-.01*t),this.message+="\nTHE FARM SPECIALIST ESTIMATES YOUR CROP AS IT NOW STANDS\nAT "+Math.round(10*this.data.riceYield/50)/10+" CAVANS PER HECTARE.\n\nDo you think that SHE is correct?\n"},input:function(){this.transition("processing3")}},processing3:{_onEnter:function(){this.message="\nW E L L   DON'T COUNT ON THAT FOR HARVEST!!!!\n",this.data.skipIntro||(this.message+="\nBrown plant hopper IS A VERY COMMON INSECT PEST. LOSS OF CROP\nMAY BE ANYWHERE FROM 0% TO 15% if INSECTICIDE IS USED\nAS SOON AS INFESTATION IS DISCOVERED (DEPENDING UPON DEGREE\nOF INFESTATION). However, if CONTROLS ARE NOT USED, LOSSES\nMAY RUN AS HIGH AS 30%. ON A SLIDING SCALE FROM 0 TO 10:\n\n0 (NONE)...............5 (AVERAGE)..............10 (SEVERE)\n"),this.message+="\n",this.insectAttack=0,this.data.costs.earlyPestControl?(this.insectAttack=Math.floor(10*Math.random())+1,"IR64"===this.data.seedType&&(this.insectAttack/=2)):(this.message+="DESPITE THE EARLY PEST CONTROL PROGRAM YOU HAVE SOME SIGNS OF\nINSECT ATTACK. (BUT MUCH LESS THAN YOUR NEIGHBOR TO THE\nEAST). YOU CAN FIGHT THE ATTACK WITH A SPRAYED INSECTICIDE.\n",this.insectAttack=Math.floor(5*Math.random())+1,"IR64"===this.data.seedType?this.insectAttack/=2:this.insectAttack<=0&&(this.message+="YOUR EARLY PEST CONTROL PROGRAM WAS SO EFFECTIVE THAT")),this.message+="THE DEGREE OF INSECT ATTACK THIS YEAR IS "+this.insectAttack+"\n\nDO YOU WISH TO SPRAY AN INSECTICIDE?\n"},input:function(t){var e;e=this.getYesNo(t),this.errorFlag||(e?(this.data.costs.insecticide=168,this.data.hours.insecticide=16):(this.data.costs.insecticide=0,this.data.hours.insecticide=0,this.insectAttack*=2),this.data.riceYield*=1-.015*this.insectAttack,this.transition("processing4"))}},processing4:{_onEnter:function(){this.message="",this.data.skipIntro||(this.message+="\nBEING A GOOD ECOLOGY MINDED FARMER YOU DID NOT KILL OR \nPOISON THE BIRDS. THEY ARE NOW EATING THE RIPENING GRAIN.\n"),this.message+="\nDO YOU WISH TO PROTECT YOUR CROP AGAINST BIRDS?\n"
},input:function(t){var e,n;n=this.getYesNo(t),this.errorFlag||(e=6*Math.random()+1,this.message="",n?(this.data.runCount<=4&&(this.message+="\nYOU AND YOUR SONS WILL TAKE TURNS STANDING IN THE FIELDS\nWAVING FLAGS AND USING SLINGSHOTS ON THE LITTLE PESTS."),this.data.hours.birdRepelling=56,e=Math.floor(e/2+.5),this.message+="\nYOUR BIRD LOSS HAS BEEN REDUCED TO ONLY "+e+" PERCENT!\n"):(this.data.hours.birdRepelling=0,this.message+="\nOH WELL, THEY WILL GET ONLY ABOUT "+e+" PERCENT.\n"),this.data.riceYield*=1-.015*e,this.transition("processing5"))}},processing5:{_onEnter:function(){this.data.typhoonLevel=Math.floor(10*Math.random()),this.message=this.data.typhoonLevel<=4?"\nYour prayer has worked. The typhoon missed your area!\n":"\nSECOND TYPHOON WARNING. IT'S COMING YOUR WAY.\n",this.message+="\nRATS ARE ATTACKING RICE IN SOME FIELDS TO THE SOUTH OF YOUR\nFARM - DO YOU WISH TO SET OUT POISON?\n"},input:function(t){var e;e=this.getYesNo(t),this.errorFlag||(this.data.ratDamage=Math.abs(Math.sqrt(-2*Math.log(Math.random()))*Math.sin(2*Math.PI*Math.random())),this.message="",e?this.transition("raticides"):(this.data.costs.rodenticide=0,this.data.hours.rodenticide=0,this.transition("processing6")))}},raticides:{_onEnter:function(){this.message="",this.data.skipIntro||(this.message+="\nACUTE RATICIDES GIVE SPECTACULAR RESULTS BUT IN THE LONG\nRUN CHRONIC POISONS ARE MORE EFFECTIVE AS WELL AS MORE\nCOSTLY AND TIME CONSUMING,\n"),this.message+="\nDO YOU WISH TO USE 'CHRONIC' OR 'ACUTE' POISON?\n"},input:function(t){this.data.poison=this.getResponse("CHRONIC,ACUTE",this.data.poison,t),this.errorFlag||(this.message="","CHRONIC"===this.data.poison?(this.data.skipIntro||(this.message="\nYOU HAVE CHOSEN WARFARIN IN .5% CONCENTRATION. YOU MUST\nMIX IT WITH 19 PARTS OF CEREAL, WRAP IT IN BANANA LEAVES\nAND PLACE IT ALONG RAT RUNS.  DO THIS EACH DAY FOR 2 WEEKS.\n"),this.data.costs.rodenticide=67.5,this.data.hours.rodenticide=42):(this.data.skipIntro||(this.message="\nYOU WILL USE ZINC PHOSPHIDE. MIX IT WITH 150 PARTS OF \nBAIT AND PLACE IT ON RAT RUNS. BE CAREFUL - ONCE THIS REACHES\nTHE STOMACH (RAT OR HUMAN) IT RELEASES PHOSPHINE GAS\nCAUSING TOTAL PARALYSIS OF THE CENTRAL NERVOUS SYSTEM. IT\nIS VERY DANGEROUS. SOMEONE MAY GET HURT. RATS POISONED THIS\nWAY ARE RENDERED INEDIBLE!\n"),this.data.costs.rodenticide=48,this.data.hours.rodenticide=9),this.transition("processing6"))}},processing6:{_onEnter:function(){this.data.costs.rodenticide>0?(this.data.ratDamage=Math.floor(5*this.data.ratDamage),this.message+="\nYOU HAVE CUT YOUR POTENTIAL RAT LOSS DRAMATICALLY.\nCONGRATULATIONS! ONLY "+this.data.ratDamage+" PERCENT OF THE CROP WAS LOST.\n"):(this.data.ratDamage=Math.floor(15*this.data.ratDamage),this.message=this.data.ratDamage>24?"\nTHE PALAY WAS DOING WELL - BUT, MAN - DID YOU GET HIT BY\nRATS!! 10 DAYS BEFORE HARVEST THEY DESCENDED LIKE THE PLAGUE\nAND RUINED "+this.data.ratDamage+" PERCENT OF YOUR STAND.  EGAD!!\n":this.data.ratDamage>12?"\nCROP LOOKED GOOD BUT IN THE WEEK BEFORE HARVEST MANY RATS\nCONVERGED ON THE FIELDS AND DESTROYED "+this.data.ratDamage+" PERCENT OF\nTHE STANDING CROP.  BETTER LUCK NEXT YEAR!!\n":"\nYOU WERE VERY LUCKY THIS SEASON, PALAY GREW WELL AND YOU\nLOST ONLY "+this.data.ratDamage+" PERCENT OF THE CROP TO RATS.\n"),this.data.riceYield*=1-.01*this.data.ratDamage,this.data.typhoonLevel>8?(this.message+="\nTOUGH LUCK. THE TYPHOON PASSED THROUGH YOUR PROVINCE AND\nTHE CROP IS IN A TERRIBLE MESS.\n",this.data.riceYield*=.65):this.data.typhoonLevel>4&&(this.message+="\nTHE TYPHOON PASSED CLOSE BY. HIGH WIND AND HEAVY RAIN CAUSED\nGREAT LODGING BUT MUCH OF THE CROP CAN BE SAVED.\n",this.data.riceYield*=.8),this.data.wages<90?(this.message+="\n\nYour wages are so low that it is almost impossible to hire\nanyone. Work has been delayed and yield has suffered!\n",this.data.riceYield*=.75):this.data.wages<=100&&(this.message+="\n\nYour wage rate is so low that you attracted only very LAZY\nworkers.  WHAT A SHAME!     !\n",this.data.riceYield*=.88),this.calculateFinalDetails(),this.message+="\nWOULD YOU LIKE A COMPLETE COST-YIELD ANALYSIS?\n"},input:function(t){this.costYield=this.getYesNo(t),this.errorFlag||this.transition("header")}},header:{_onEnter:function(){return this.message="\n\n\n----------------------------------------------------------------\n\n\n\n       ECONOMICS OF RICE PRODUCTION IN THE PHILIPPINES\n\n\n\nRICE TYPE: "+this.data.seedType+"\n\nFARM SIZE: "+this.data.farmSize+" HECTARES\nTOTAL YIELD: "+Math.round(this.totalYield)+" KILOGRAMS\n\n              ("+Math.round(10*this.totalYield/50)/10+" CAVANS PER HA.)\n\n\n.........................\n"+this.waitText},input:function(){this.transition(this.costYield?"costYield":"summary")}},costYield:{_onEnter:function(){return this.message="\n                                        Land Reform Owner\nOPERATING COST:\n\nMATERIAL INPUTS\n",this.totalCosts("earlyPestControl")>0&&(this.message+=sprintf(this.FMT2," MATERIALS - EARLY PEST CONTROL",this.totalCosts("earlyPestControl"))+"\n"),this.message+=sprintf(this.FMT2," SEEDS(50 KG/HA)",this.totalCosts("seeds"))+"\n",this.totalCosts("fertilizer")>0&&(this.message+="    FERTILIZER (UREA) @"+this.data.fertCost+" PESOS/KG.\n"+sprintf(this.FMT2,"  ",this.totalCosts("fertilizer"))+"\n"),this.totalCosts("insecticide")>0&&(this.message+=sprintf(this.FMT2,"INSECTICIDE @112 PESOS/BOTTLE",this.totalCosts("insecticide"))+"\n"),this.totalCosts("weeding")>0&&(this.message+=sprintf(this.FMT2,"HERBICIDE (.8KG AI/HA)",this.totalCosts("weeding"))+"\n"),this.totalCosts("rodenticide")>0&&(this.message+=sprintf(this.FMT2,"RODENTICIDE AND BAIT",this.totalCosts("rodenticide"))+"\n"),this.totalCosts("molluscicide")>0&&(this.message+=sprintf(this.FMT2,"MOLLUSCICIDE",this.totalCosts("molluscicide"))+"\n"),this.message+="\n"+this.waitText},input:function(){this.transition("costYield2")}},costYield2:{_onEnter:function(){return this.message="\nSEEDBED PREPARATION -- 4 DAYS WORKER AND\n",this.message+="HIRE"===this.data.ownOrHire?"    CARABAO AT "+6*this.CARABAO_RATE+" PESOS PER DAY\n"+sprintf(this.FMT2,"  ",this.totalCosts("seedbedPrep")):"    CARABAO. SEE 'LAND PREPARATION' FOR\n    COST OF OWNING ANIMAL\n"+sprintf(this.FMT2,"OPERATOR'S LABOR",this.labor("seedbedPrep")),this.message+="\n"+this.waitText},input:function(){this.transition("costYield3")}},costYield3:{_onEnter:function(){return this.message="\nLAND PREPARATION -- PLOWING AND HARROWING\n",this.message+="TRACTOR"===this.data.prepMethod?"    "+this.data.farmSize*this.TRACTOR_HOURS/8+" TRACTOR DAYS @"+8*this.TRACTOR_RATE+" PESOS/DAY\n"+sprintf(this.FMT2,"  ",this.totalCosts("landPrep")):"HIRE"===this.data.ownOrHire?"   "+this.data.farmSize*this.CARABAO_HOURS/6+" DAYS FOR CARABAO\n    AT "+6*this.CARABAO_RATE+" PESOS PER DAY\n"+sprintf(this.FMT2,"  ",this.totalCosts("landPrep")):""+sprintf(this.FMT2,"COST OF OWNING CARABAO",this.totalCosts("landPrep"))+"\n"+sprintf(this.FMT2,"OPERATORS LABOR",this.labor("landPrep")),this.message+="\n"+this.waitText},input:function(){this.transition("costYield4")}},costYield4:{_onEnter:function(){return this.message="\n",this.labor("earlyPestControl")>0&&(this.message+=""+sprintf(this.FMT2,"LABOR - EARLY PEST CONTROL",this.labor("earlyPestControl"))+"\n"),this.labor("molluscicide")>0&&(this.message+=sprintf(this.FMT,"LABOR FOR SNAIL REMOVAL",this.labor("molluscicide"))+"\n"),this.totalCosts("fertilizer")>0&&(this.message+="COSTS OF APPLYING FERTILIZER\n    "+this.data.farmSize*this.data.hours.fertilizer/8+" PERSON DAYS @"+this.data.wages+" PESOS/DAY\n"+sprintf(this.FMT2,"  ",this.labor("fertilizer"))),this.message+="\n"+sprintf(this.FMT,"TRANSPLANTING - 18 WORK DAYS/HA",this.labor("transplanting"))+"\n"+this.waitText},input:function(){this.transition("costYield5")}},costYield5:{_onEnter:function(){return this.message="\n",this.labor("insecticide")>0&&(this.message+="\n APPLICATION OF PESTICIDE\n     2 DAYS PER HA. AT "+this.data.wages+" PESOS PER DAY\n "+sprintf(this.FMT2,"  ",this.labor("insecticide"))+"\n"),"0"!==this.data.weedingMethod&&(this.message+="WEEDING COSTS -- METHOD "+this.data.weedingMethod+"\n    "+this.data.hours.weeding+" HOURS PER HECTARE\n"+sprintf(this.FMT2,"  ",this.labor("weeding"))+"\n"),this.labor("birdRepelling")>0&&(this.message+=sprintf(this.FMT,"CHILD LABOR FOR BIRD WATCH",this.labor("birdRepelling")/2)+"\n"),this.labor("rodenticide")>0&&(this.message+=sprintf(this.FMT,"APPLICATION OF RODENTICIDE",this.labor("rodenticide"))+"\n"),this.message+=""+this.waitText},input:function(){this.transition("costYield6")}},costYield6:{_onEnter:function(){return this.message="\nHARVESTING COSTS\n"+sprintf(this.FMT2,"HARVEST RATE - 32 KG/WORK HR",this.labor("harvesting"))+"\n\nTHRESHING\n",this.message+="HAND"===this.data.threshingMethod?sprintf(this.FMT2,"RATE ABOUT 40 KG/HR",this.labor("threshing")/2)+"\n":sprintf(this.FMT2,"COST BY MACHINE - 5% OF YIELD",this.totalCosts("threshing"))+"\n",this.message+="\n"+sprintf(this.FMT,"HAULING COST - .012 PESOS/KG",this.totalCosts("hauling"))+"\n"+this.waitText},input:function(){this.transition("costYield7")}},costYield7:{_onEnter:function(){return this.message="\n                                     ---------------------\n"+sprintf(this.FMT2,"   TOTAL OPERATING COSTS",this.operatingCosts)+"\n\nNOTE, HOWEVER, THAT A CONSIDERABLE PORTION OF THE FARMER'S\nCOSTS ARE IN TERMS OF personal AND family LABOR.\n\n\n.........................\n"+this.waitText},input:function(){this.transition("costYield8")}},costYield8:{_onEnter:function(){return this.message="\n\nFIXED COSTS\n"+sprintf(this.FMT2,"IRRIGATION FEES - 945 PESOS/HA",this.totalCosts("irrigation"))+"\n"+sprintf(this.FMT2,"LAND TAX - 1050 PESOS/HA",this.totalCosts("landTax"))+"\n"+sprintf(this.FMT2,"PAY MORTGAGE - 4% OVER 20 YEARS",this.mortgage)+"\n                                     ---------------------\n\n"+sprintf(this.FMT,"T O T A L  C O S T S",this.operatingCosts+this.totalCosts("irrigation")+this.totalCosts("landTax")+this.mortgage)+"\n\n. . . . . . . . . . . . . . . . . . . .\n\n"+this.waitText},input:function(){this.transition("summary")}},summary:{_onEnter:function(){var t,e;return e=this.operatingCosts+this.totalCosts("irrigation")+this.totalCosts("landTax")+this.mortgage,t=this.totalYield*this.data.price-e,t=Math.round(100*t)/100,this.message="\nS U M M A R Y\n                                        LAND REFORM OWNER\n  TOTAL VALUE OF "+Math.round(100*this.totalYield)/100+" KILOGRAMS\n  OF PALAY AT "+this.data.price+"\n  PESOS PER KILOGRAM                        "+Math.round(this.totalYield*this.data.price*100)/100+"\n\n  LESS TOTAL EXPENSES                       "+Math.round(100*e)/100+"\n                                     --------------------\n\n N E T  P R O F I T                         "+t+"\n\n   Feels good to own your own land - DOESN'T IT???\n\n",t<2800*this.data.farmSize?this.message+="YOU ARE ONE HECK OF A POOR FARMER - YOUR KIDS WILL STARVE\nAT THAT RATE.  YOU MADE AT LEAST ONE terrible DECISION.\nYOU HAD BETTER CORRECT IT BEFORE NEXT SEASON.\n":t<4500*this.data.farmSize&&(this.message+="THAT IS NOT A GOOD YEAR AT ALL. BETTER IMPROVE YOUR TECHNIQUE\nOR YOU WILL LOSE THE LAND YOU WORKED SO HARD TO EARN\n"),this.message+="----------------------------------------------------------------\n"+this.waitText},input:function(){this.transition("runAgain")}},runAgain:{_onEnter:function(){return this.message="\n\n",this.data.skipIntro||(this.message+="YOU WILL NOW HAVE THE OPTION OF RERUNNING THE PROGRAM.\nYOU MAY KEEP THE SAME RICE TYPE OR YOU MAY CHANGE.\nIN EITHER CASE THE INPUTS WILL REMAIN AS FOR THE FIRST\nCROP UNTIL YOU DECIDE TO ADOPT A DifFERENT TECHNOLOGY."),this.message+="\n\nDO YOU WISH TO RUN THE PROGRAM AGAIN?\n\n"},input:function(t){var e;e=this.getYesNo(t),this.errorFlag||this.transition(e?"changeFactors":"goodbye")}},changeFactors:{_onEnter:function(){return this.data.runCount++,this.message="WHICH FACTOR DO YOU WISH TO CHANGE\n\nENTER '0' (ZERO) if YOU DESIRE NOT TO CHANGE ANYTHING.\nOTHERWISE ENTER a number from the list below.\n1   'SIZE OF FARM'\n2   'COST OF OUTSIDE LABOR'\n3   'TYPE OF RICE (SEED) USED'\n4   'COST OF SEED'\n5   'USE OF SYSTEMIC PESTICIDE, I.P.M., OR NOTHING' \n6   'COST AND AMOUNT OF NITROGEN FERTILIZER'\n7   'METHOD OF CROPLAND PREPARATION' \n8   'METHOD OF WEEDING AND SNAIL PROTECTION'\n9   'METHOD OF THRESHING' \n10   'MARKET VALUE OF ROUGH RICE'\n\nRemember, in a controlled experiment you can change only\nONE factor at a time! WHICH ONE???\n"},input:function(t){if(this.rerunFactor=this.getResponse([0,1,2,3,4,5,6,7,8,9,10].join(","),this.rerunFactor,t),!this.errorFlag)switch(this.rerunFactor){case"0":this.transition("startProcessing");break;case"1":this.transition("setFarmSize");break;case"2":this.transition("setWages");break;case"3":this.transition("setSeedType");break;case"4":this.transition("setSeedCost");break;case"5":this.transition("setPesticide");break;case"6":this.transition("setFertilizer");break;case"7":this.transition("setLandPrep");break;case"8":this.transition("setWeeding");break;case"9":this.transition("setThreshing");break;case"10":this.transition("setMarketValue")}}},goodbye:{_onEnter:function(){return this.message="\n\n\nTHANKS FOR PLAYING RICEGROW!\n\n\n"},input:function(){this.message=""}}},waitText:"\nPress Enter to continue...\n",getYesNo:function(t){var e;return this.errorFlag=!1,e=t.trim().toUpperCase(),"YES"===e||"Y"===e||"NO"===e||"N"===e?"YES"===e||"Y"===e:(this.errorFlag=!0,void(this.message="Please enter 'YES' or 'NO'\n"))},getNumber:function(t,e){var n;if(this.sameFlag=!1,this.errorFlag=!1,n=e.trim().toUpperCase(),"SAME"===n){if(null!==t)return this.sameFlag=!0,t;this.message="You cannot use the same value\n",this.errorFlag=!0}else{if(!isNaN(parseFloat(n)))return parseFloat(n);this.message="Please type a number\n",this.errorFlag=!0}},getResponse:function(t,n,i){var s;if(this.sameFlag=!1,this.errorFlag=!1,s=i.trim().toUpperCase(),"SAME"===s){if(null!==n)return this.sameFlag=!0,n;this.message="You cannot use the same value\n",this.errorFlag=!0}else{if(e.contains(t.split(","),s))return s;this.message="That is not a legal response. Please retype.\n",this.errorFlag=!0}},calculateFinalDetails:function(){var t;return this.data.hours.harvesting=.0311*this.data.riceYield,this.data.costs.threshing=this.data.hours.threshing=0,"MACHINE"===this.data.threshingMethod?(this.data.riceYield*=.97,this.data.costs.threshing=.05*this.data.riceYield*this.data.price):this.data.hours.threshing=.05*this.data.riceYield,this.data.costs.hauling=.012*this.data.riceYield,t=this.totalCosts("earlyPestControl"),t+=this.totalCosts("seeds"),t+=this.totalCosts("fertilizer"),t+=this.totalCosts("insecticide"),t+=this.totalCosts("weeding"),t+=this.totalCosts("rodenticide"),t+=this.totalCosts("molluscicide"),t+=this.totalCosts("seedbedPrep")+this.labor("seedbedPrep"),t+=this.totalCosts("landPrep")+this.labor("landPrep"),t+=this.labor("earlyPestControl"),t+=this.labor("fertilizer"),t+=this.labor("transplanting"),t+=this.labor("insecticide"),t+=this.labor("weeding"),t+=this.labor("molluscicide"),t+=this.labor("birdRepelling")/2,t+=this.labor("rodenticide"),t+=this.labor("harvesting"),t+=this.totalCosts("threshing"),t+=this.labor("threshing"),t+=this.totalCosts("hauling"),this.operatingCosts=t,this.totalYield=this.data.riceYield*this.data.farmSize,this.mortgage=this.totalYield*this.data.price*4*.07}}),n=t("#console").jqconsole("    ARE YOU FAMILIAR ENOUGH WITH THE PROGRAM TO WISH TO SKIP\n    ALL PRELIMINARIES?  \n","> "),(s=function(){n.Prompt(!1,function(t){return i.handle("input",t),n.Write(i.message),s()})})()})}(jQuery,_)}.call(this);